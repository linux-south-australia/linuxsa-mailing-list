<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="a question about network accounting services in linux" -->
<!-- FromName="Jason Nunn" -->
<!-- FromEmail="jsno@downunder.net.au" -->
<!-- ToName="" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Tue, 11 Jul 2000 16:59:11 +0930 (CST)" -->
<!-- Id="Pine.LNX.4.21.0007111654550.816-100000@berkeley.localnet" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: a question about network accounting services in linux</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Jason Nunn &lt;<I><A HREF="mailto:jsno@downunder.net.au">jsno@downunder.net.au</A></I>&gt;
  To  : <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>
  Date: Tue, 11 Jul 2000 16:59:11 +0930 (CST)
</PRE>
<H1>a question about network accounting services in linux</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
hello

i want to add a custom facility into the kernel (i haven't decided what
version yet - 2.2 or 2.3) that will provide extra network accounting.
before i go charging ahead ;), i just want to check with a few hackers on
this listserver incase 2.2 or 2.3 already has the facility i want, and
possibly some opinions about this as well. i've had a detailed look at
2.2, and i'm pretty sure it hasn't. as for 2.3 ..... i don't know.

here is my problem: i've been asked by an ISP to write a custom program
that "accurately" tracks network volumes of users and hosts. the ISP only
wants to charge the users/hosts for those packets that go in/out of their
network, and they don't want to charge for internal network activity
(ie, hitting the mail server).

so, i need to write a user space program to track where sources (ip
sources) send/receive data, and the amount of data that's tranferred. for
that, i need to either find a kernel service that can accurately aid in
getting me this info, or create my own service.

i know there are methods like polling the kernels internal data structs
via a socket that will achieve this (which i've used before in another
distribution), but there's always doubts about polling as events can
sometimes happen too quicky for the polling program to notice. so i want
to try a new method.

i was thinking about adding a few routines into the kernel (in
linux/net/core/dev.c) that puts "&lt;ip source&gt; &lt;ip destination&gt; &lt;dev&gt; &lt;data
length&gt;" into a queue, and create a character device module (/dev/....)
that allows a user space program to "pull" entries off the queue. the idea
here is to make *every* single packet accountable, and there would be no
possibly of a packet getting missed like in polling.

are there any kernel hackers here?. does a facility like this exist in 2.2
or 2.3 ?. if not, then i would love your opinion about this idea.


cheers

-- 
Jason Nunn- Darwin, Northern Territory- jsno.downunder.net.au

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
