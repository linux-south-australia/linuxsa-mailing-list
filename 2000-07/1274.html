<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Trace Route" -->
<!-- FromName="Dan Shearer" -->
<!-- FromEmail="dan@shearer.org" -->
<!-- ToName="linuxsa" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Mon, 24 Jul 2000 07:10:22 +0930 (CST)" -->
<!-- Id="Pine.LNX.4.10.10007240618370.16392-100000@localhost.localdomain" -->
<!-- Reference="Pine.BSF.4.21.0007232246380.47306-100000@augustus.tellurian.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Trace Route</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Dan Shearer &lt;<I><A HREF="mailto:dan@shearer.org">dan@shearer.org</A></I>&gt;
  To  : linuxsa &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Mon, 24 Jul 2000 07:10:22 +0930 (CST)
</PRE>
<H1>Re: Trace Route</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Sun, 23 Jul 2000, David Newall wrote:

&gt; Some sites filter out ICMP messages in the mistaken belief that this
&gt; improves security.  Traceroute does not work through such filters.

It isn't always quite that simple.  
<A HREF="http://www.faqs.org/faqs/computer-security/most-common-qs/section-18.html">http://www.faqs.org/faqs/computer-security/most-common-qs/section-18.html</A>
covers "Should I block all ICMP at my firewall/router?" A good answer is
given why three types of ICMP packet should not be blocked (because doing
so makes some networks inaccessible, or partly inaccessible). As for the
other packet types, well it depends.

The famous "ping of death" incident (a hilarious bug, exploitable from the
Windows command prompt, look it up! :-) isn't justification for blocking
ICMP. Go and read the security lists for genuine security experts'
opinions on why.

ICMP tunnelling is often cited as a reason for blocking ICMP. See Phrack's
web site at <A HREF="http://www.phrack.com/.">http://www.phrack.com/.</A>  "Project Loki: ICMP Tunnelling",
Phrack 49, File 6 of 16, 1996.  "LOKI2 (the implementation)", Phrack 51,
File 6 of 17, 1997.

Should ICMP tunnelling scare everyone into blocking most or all of
ICMP? When Phrack 49 was first published that was my first reaction, then
I read it again and realised that ICMP tunnelling is a very clever and
subtle implementation of something that can be done in many other ways and
be almost as difficult to spot. So it actually is quite a difficult
question to answer without ending up with silly security policies as a
result.

Following are a few paragraphs extracted from the first paper
(<A HREF="http://www.2600.com/phrack/p49-06.html">http://www.2600.com/phrack/p49-06.html</A>) on the topic.

====== start phrack quotation

Ping traffic is ubiquitous to almost every TCP/IP based network and
subnetwork. It has a standard packet format recognized by every
IP-speaking router and is used universally for network management,
testing, and measurement.  As such, many firewalls and networks consider
ping traffic to be benign and will allow it to pass through, unmolested.  
This project explores why that practice can be insecure.  Ignoring the
obvious threat of the done-to-death denial of service attack, use of ping
traffic can open up covert channels through the networks in which it is
allowed.

   :
   :

                Section IV.     Discussion, Detection and Prevention

        If ICMP_ECHO traffic is allowed, then this channel exists.  If
this channel exists, then it is unbeatable for a backdoor (once the system
is compromised).  Even with extensive firewalling and packet-filtering
mechanisms in place, this channel continues to exist (provided, of course,
they do not deny the passing of ICMP_ECHO traffic).  With a proper
implementation, the channel can go completely undetected for the duration
of its existence.

        Detection can be difficult.  If you know what to look for, you may
find that the channel is being used on your system.  However, knowing when
to look, where to look, and the mere fact that you *should* be looking all
have to be in place.  A surplus of ICMP_ECHOREPLY packets with a garbled
payload can be ready indication the channel is in use.  The standalone
Loki server program can also be a dead give-away.  However, if the
attacker can keep traffic on the channel down to a minimum, and was to
hide the Loki server *inside* the kernel, detection suddenly becomes much
more difficult.

    :
    :

NOTE: This channel exists in many other protocols.  Loki Simply covers 
ICMP, but in theory (and practice) any protocol is vulnerable to covert 
data tunneling.  All that is required is the ingenuity...

====== end phrack quotation


Dan

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
