<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: [OT] tracking spoofing spammer (saga)" -->
<!-- FromName="'David Newall'" -->
<!-- FromEmail="davidn@rebel.net.au" -->
<!-- ToName="" -->
<!-- ToEmail="dan.kortschak@adelaide.edu.au,linuxsa@linuxsa.org.au" -->
<!-- Date="Sat, 9 Dec 2000 20:31:46 +1030" -->
<!-- Id="004b01c061c7$0be18890$4c4514cb@SMARTPANEL" -->
<!-- Reference="3A3188B4.E213F3FF@adelaide.edu.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: [OT] tracking spoofing spammer (saga)</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: David Newall &lt;<I><A HREF="mailto:davidn@rebel.net.au">davidn@rebel.net.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:dan.kortschak@adelaide.edu.au">dan.kortschak@adelaide.edu.au</A></I>&gt;<BR>        &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Sat, 9 Dec 2000 20:31:46 +1030
</PRE>
<H1>Re: [OT] tracking spoofing spammer (saga)</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Dan,

Email is not secure.  When you receive email from <A HREF="mailto:j.doe@morgue.gov">j.doe@morgue.gov</A> there is
only one thing which you can be immediately sure about, and that is that you
received the email.  You particularly cannot be sure that is was sent by
j.doe, nor indeed do you know that it was sent from morgue.gov.  You can
trace backwards to try to find out where the email came from.

Here are the (relevant) headers of the email message that I received, in
which you asked what you can do to track the spammer:


  Received: from Elizabeth.netcraft.com.au (elizabeth.netcraft.com.au
[203.16.231.67])
            by rebel.net.au (8.8.5/8.8.4) with ESMTP
     id LAA05185; Sat, 9 Dec 2000 11:57:26 +1030
  Received: (from <A HREF="mailto:maillist@localhost">maillist@localhost</A>)
   by Elizabeth.netcraft.com.au (8.8.5/8.8.5) id LAA21440;
   Sat, 9 Dec 2000 11:49:41 +1030
  From: Dan Kortschak &lt;<A HREF="mailto:dan.kortschak@adelaide.edu.au">dan.kortschak@adelaide.edu.au</A>&gt;
  To: <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>


The From and To header are cannot be trusted.  Maybe you sent the message;
maybe you didn't.  Maybe the message was addressed to linuxsa; maybe it was
addressed to me; maybe it wasn't addressed to anybody at all.  I cannot tell
any of these things because the mail network does not carry that information
in the mail message, but rather in an envelope which is discarded on final
delivery.  The mail message does have sender and recipient information (ie
From and To), but that is just as reliable as the Subject, ie not at all.

The Received headers are the only headers  you can trust, and those can only
be trusted so far.  My mail system puts a Received header at the top of the
list, and I know I can trust it, so with a little digging I can know the
following:

  Received: from Elizabeth.netcraft.com.au (elizabeth.netcraft.com.au
[203.16.231.67])
            by rebel.net.au (8.8.5/8.8.4) with ESMTP
     id LAA05185; Sat, 9 Dec 2000 11:57:26 +1030

Your message came to me via Elizabeth.netcraft.com.au on 9 Decem ber at
11:57am (plus or minus rebel's clock drift.)  If I can trust
Elizabeth.netcraft.com.au, and I believe I can, then I can also be
reasonably sure of the following:

  Received: (from <A HREF="mailto:maillist@localhost">maillist@localhost</A>)
   by Elizabeth.netcraft.com.au (8.8.5/8.8.5) id LAA21440;
   Sat, 9 Dec 2000 11:49:41 +1030

So Netcraft received it from their local maillist user, which I assume is a
psuedo-user.  Were there more Received headers I could consider each in
turn, deciding how much to trust them.  I could also contact the
administrators, going back through the chain of delivery, until I found the
likely source of the message.  Note that mail systems are not obliged to put
their Received header (ie postmark) at the top of the list, although I
suppose most of them do.  The point being that suppose there was a list of
Received headers, aside from the one that rebel put on, then I would have to
ask Netcraft which was the one that they put on.

Let's look at a message which I kept in my spam zoo:

  Received: from ns2.netdor.com ([209.25.83.3])
            by rebel.net.au (8.8.4/8.8.4) with ESMTP
            id SAA08586 for &lt;<A HREF="mailto:davidn@rebel.net.au">davidn@rebel.net.au</A>&gt;; Mon, 4 Aug 1997 18:04:31
+0930
  From: <A HREF="mailto:05426368@spica.net">05426368@spica.net</A>
  Received: from [209.25.83.3] ([38.28.35.109]) by ns2.netdor.com
            (post.office MTA v1.9.3b evaluation license) with SMTP id
AAM189;
            Sun, 3 Aug 1997 21:18:22 -0400
  Received: from <A HREF="mailto:get@noticed.public">get@noticed.public</A> by <A HREF="mailto:get@noticed.public">get@noticed.public</A> (8.8.5/8.6.5) with
SMTP id
   GAA02846 for &lt;<A HREF="mailto:get@noticed.public">get@noticed.public</A>&gt;; Sun, 03 Aug 1997 18:32:44 -0600 (EST)

I know it was received by ip address 209.25.83.3 (because I trust rebel),
and I know it was received on August 4, 1997, at 6:04pm.  The chances are
that 209.25.83.3 is NOT ns2.netdor.com.  Certainly there is no record
mapping the address to the name, although perhaps that's because netdor.com
haven't setup their DNS correctly.  Of course the spam is so old that maybe
the domain and the ip address are different now, but a traceroute to
209.25.83.3 should help me discover who is responsible:

Apparently the IP address is no longer reachable, or maybe it's just a
temporary routing problem.  At any rate the last hop that contains useful
information is:

  19  g-nyd-br-01-f5-0.gn.cwix.net (206.142.243.3)  491.65 ms  432.166 ms
484.368 ms

So I should contact cwix.net.  I suspect g-nyd-br-01-f5-0 indicates a New
York gateway, but that's just a guess and not important at this stage.

Suppose there was a domain name for 209.25.83.3, lets say it really was
ns2.netdor.com.  I would then look at the next Received line:

  Received: from [209.25.83.3] ([38.28.35.109]) by ns2.netdor.com
            (post.office MTA v1.9.3b evaluation license) with SMTP id
AAM189;
            Sun, 3 Aug 1997 21:18:22 -0400

I must also say that the From line appearing between the two Received lines
is probably significant.  However if we trust ns2.netdor.com, which we have
no reason to do, then they received it from 38.28.35.109.  In fact it seems
more likely to me that the message originated from 209.25.83.3, and I would
contact the administrator of the owner of that address, or of their upstream
connection, or both.  The dates on the received headers, and perhaps the
message-id's, will be useful for them to track down who sent the message.

Most spam is sent from dialup accounts, so you might well discover that the
last trustworthy received header is something like:

  Received: from success.entreprenuers.net
(8.san-diego-001.ca.dial-access.att.net
    [207.147.152.8]) by inet1.inetworld.net (8.8.4/8.6.12) with SMTP id
TAA06608;
    Fri, 25 Jul 1997 19:41:52 -0700 (PDT)

The name (8.san-diego-001.ca.dial-access.att.net) sort of lets you know that
it's a dialup port, and that it's operated by att.net.  In this case I'd
contact att.net to find out who was dialed into that modem at that time.

Once you have found the source of the message, if they refuse to do anything
about it there are a number of steps you can take.  You can lodge a
complaint with the Australian Federal Police, although this is not likely to
go far unless you can make a reasonable claim of an actual monetary loss,
and assuming you can prove the facts such as they are.  If you charge a fee
for all unsolicited email, such charge to be waived at your discretion, and
if you notify the sender before they send you the email, perhaps by having
it on your web site and certainly in your smtp daemon's hello banner, then
maybe -- MAYBE -- you have justified a monetary loss if they don't pay the
amount you charge.  Charge something large but reasonable, say $1,000,000
per message, so then you can say to AFP that they have tried to disguise
their identity in order to evade paying an agreed million dollar fee.

Another thing you can do, and perhaps it's going to be more effective, is to
register the sender with as many spam black lists as you can.  Search the
web for spam black list sites.  It's worth observing that small ISPs might
be willing to ignore a message to their abuse-line that says, "hey I'm in
Australia and you or your customer is spamming me.  stop it or I'll stamp my
foot."  They are less likely to ignore a message that says, "hey I'm in
Australia and you or your customer is spamming me.  Since you ignored my
previous messages to you I'm listing in you in xyz black list, abc black
list and def  black list too."  You should also configure your smtp daemon
to check the black lists on all incoming mail.

Beware black lists: a black listed site is not necessarily sending you spam.
It may be that your important customer uses a black listed site, and thus
you might make it hard to do business with someone who you really do want to
do business with.  These black lists are indeed a two-edged sword.

Good luck.

David

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
