<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Have I been cracked?" -->
<!-- FromName="Adam Hawes" -->
<!-- FromEmail="adam_hawes@dingoblue.net.au" -->
<!-- ToName="Mark Phillips" -->
<!-- ToEmail="mark@ist.flinders.edu.au" -->
<!-- Date="Tue, 03 Oct 2000 18:37:00 +0930" -->
<!-- Id="39D9A1B4.ABB743B1@dingoblue.net.au" -->
<!-- Reference="20001003150057.F10635@destiny.ist.flinders.edu.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Have I been cracked?</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Adam Hawes &lt;<I><A HREF="mailto:adam_hawes@dingoblue.net.au">adam_hawes@dingoblue.net.au</A></I>&gt;
  To  : Mark Phillips &lt;<I><A HREF="mailto:mark@ist.flinders.edu.au">mark@ist.flinders.edu.au</A></I>&gt;
  Date: Tue, 03 Oct 2000 18:37:00 +0930
</PRE>
<H1>Re: Have I been cracked?</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Mark Phillips wrote:
&gt; 
&gt; There have been a few suspicious things happening lately with my
&gt; computer.  I'm wondering if my system has been compromised in some way
&gt; or whether there's some other explanation.
&gt; 
&gt; The most recent thing happened just now.  I have a shell window where
&gt; I run the following:
&gt; 
&gt; while true; do fetchmail; sleep 100; done
&gt; 
&gt; which periodically fetches my mail and lets me see what's happening.
&gt; Today I got the following output:
&gt; 
&gt; fetchmail: 5.3.3 querying mail.infoeng.flinders.edu.au (protocol POP3) at Tue, 03 Oct 2000 14:36:22 +0930 (CST)
&gt; fetchmail: No mail for mark at mail.infoeng.flinders.edu.au
&gt; fetchmail: 5.3.3 querying mail.infoeng.flinders.edu.au (protocol POP3) at Tue, 03 Oct 2000 14:38:10 +0930 (CST)
&gt; fetchmail: No mail for mark at mail.infoeng.flinders.edu.au
&gt; fetchmail: 5.3.3 querying mail.infoeng.flinders.edu.au (protocol POP3) at Tue, 03 Oct 2000 14:39:58 +0930 (CST)
&gt; fetchmail: No mail for mark at mail.infoeng.flinders.edu.au
&gt; (null): You don't exist.  Go away.


You're hammering the server too much.  Wait 10 minutes between checking mail, and you shouldn't have the problem too much.  I'd suspect that the guys there have set it up like that to keep all the windows dicks that set Craplook or Nutscrape to check mail
every 1 minute from being able to do it as often.

&gt; Another strange occurrence happened the other day when I found the
&gt; background of my X session had changed.  It was like someone had
&gt; blatted up some image or collections of images to my background.  I
&gt; thought perhaps I had been lax in my X permissions, but doing xhost
&gt; gave:
&gt; 
&gt; $ xhost
&gt; access control enabled, only authorized clients can connect
&gt; 
&gt; So am I right that these things look suspicious?  Or is there some
&gt; other explanation.

Did you screw with any X config files, or delete any graphic files from your home dir?? There is a lot of stuff now (Gnome, KDE, WindowMaker, Enlightenment) all profide facilities for changing your wallpaper.  If you  run any/all of them (or others) then
screwing one may cause the others to assume control instead.

&gt; What kinds of things should I look for as evidence for being cracked?
&gt; Log files I presume would be a good place to start, but which ones?

Start by looking for telnet sessions in your log files. /var/log/messages /var/log/security /var/log/maillog all are good.  IF someone's hacking you the connections to the services are likely to be shown in the files above.  You'll quickly be able to see
what is normal and what is not just by looking through the files.  There'll be tonnes of stuff with your local hostnames/IP addresses, and then stuff with other hostnames/IP addresses.  Sessions to ROOT are always suspicious.

You could block all ports for the X server (around 6000 from memory) from the outside world.  That is always a good place to start.  Then you could lock down inetd.conf and take out all services that you don't use.

I think that XFree4.0.1 makes a log file as well.  You could look in there and see if it shows connections and from what IP addresses.

Hope this helps.

Cheers,
Adam

-- 
Adam Hawes

Web:       <A HREF="http://overfiend.iwarp.com">http://overfiend.iwarp.com</A>
Email:     <A HREF="mailto:adam_hawes@dingoblue.com.au">adam_hawes@dingoblue.com.au</A>
ICQ:       2492016

Voicemail: +61 (08) 8219-3238
Fax:       +61 (08) 8219-3238

-----BEGIN GEEK CODE BLOCK-----
Version: 3.12
GAT dpu s+: a-- C++++ UL++ P+ L+++ E W- N+++ o+ K- w--- 
O- M V-- PS+ PE Y++ PGP++ t 5- X+++ R* tv b+ DI+ D---- 
G e* h! r--- y** 
------END GEEK CODE BLOCK------

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
