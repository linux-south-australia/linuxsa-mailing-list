<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: modem drops out after 15 hours???" -->
<!-- FromName="Mark Newton" -->
<!-- FromEmail="newton@atdot.dotat.org" -->
<!-- ToName="jonty rhodes" -->
<!-- ToEmail="jtsoong@hotmail.com" -->
<!-- Date="Fri, 26 May 2000 01:58:58 +0930" -->
<!-- Id="20000526015858.A93936@atdot.dotat.org" -->
<!-- Reference="20000525160541.29742.qmail@hotmail.com" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: modem drops out after 15 hours???</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Mark Newton &lt;<I><A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A></I>&gt;
  To  : jonty rhodes &lt;<I><A HREF="mailto:jtsoong@hotmail.com">jtsoong@hotmail.com</A></I>&gt;
  Date: Fri, 26 May 2000 01:58:58 +0930
</PRE>
<H1>Re: modem drops out after 15 hours???</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Thu, May 25, 2000 at 01:05:41PM +0000, jonty rhodes wrote:

 &gt; We are using it for internet connectivity thru squid. When you first start 
 &gt; it up (connect), and for the first 3-5 hours it is fine, then at some point 
 &gt; it stops working properly, either you can't get to pages hosted by it (it 
 &gt; has a static IP), or you can't use it to surf out
 &gt; through the internet.. (it is NOT squid here.. we can't use the gateway 
 &gt; either at this point).
 
Have you called your ISP to get recommended init strings?  Unless
you're hitting an idle timer, this really doesn't sound like a Linux
problem at all.

 &gt; we have been trying to find the solution for about 2 weeks now,
 &gt; different modem strings etc etc.. We have also changed the timeout (
 &gt; or whatever, so it never SHOULD hang up ).

Please provide the list with config file examples so that we know what
that statement means.  Diagnosing in a vacuum of knowledge is an
exercise in futility.

 &gt; I heard that maybe the
 &gt; modem is getting tired after a period of inactivity and attempting
 &gt; to re-establish the connection, only to screw it all up????

There is an issue with V.90 modems which attempt to be "speed aggressive".
Basically, the modem negotiates a connection as fast as it can with the
ISP's NAS, but as the line transformer in the modem heats up during the
connection its electrical characteristics change, altering the acoustic
properties of the line the modem is reading;  as a result, it needs to
retrain to re-establish an optimal connection speed... and after a while,
while the line transformer continues to heat up, the problem recurs.  As
a result, the modem will retrain at intervals of about 2 minutes for the
first twenty minutes or so of a connection.

Depending on the configuration of either the modem or the NAS, it's 
possible that this retraining can cause a "How many retrains should I
do in a short period before I conclude that the line quality is hopeless?"
counter to trip-over at one end or the other, at which point the call
will terminate.

The solution is to configure the modem to be less "speed aggressive":  
Instead of negotiating the fastest speed possible and training down
from there, the mdoem should establish at a low-ish speed and 
negotiate up.

That's about the only "modem getting tired" problem I've heard of, and
it doesn't seem relevent to your case because yours is giving up after
20 hours or so, so I'd look elsewhere.  In particular, make sure your
modem is running the latest version of its firmware ("AT I" subcommands
are your friend), make sure your line quality is good (Telstra have 
a "MOLDS" test facility which your ISP will be able to help you with),
and provide us with your ppp config so we can confirm that you don't
have a session timeout or inactivity timeout set.

 &gt; any ideas here would be greatly appreciated, the boss keeps talking
 &gt; about changing to MSoft..

That could quite possibly be the stupidest thing I've heard all day, 
and I've been awake for a *very* long time so far.  An MS system as a 
PPP gateway is so woefully inadequate that I refuse to believe that
any rational, well-informed humans will ever take it seriously. 

If you can actually get it to work at all (after you find the magic
registry settings you need to frob to make the "Enable IP Forwarding"
checkbox actually enable IP forwarding) you won't get it to work reliably. 
Mixing MS Proxy Server into the morass just makes things worse, when you
get your ISP bill at the end of the month and find that it's huge because
your brain-dead proxy server has been spending all night pro-actively
sucking down megabytes worth of web sites it thinks you might want to
see during the following day even though you've hit the checkbox which
disables "Active Caching".  Ugh.

Pick operating systems which are suitable for the job they'll be doing.
UNIX-based OS's make passable firewalls.  Windows makes a good Solitaire
game.

   - mark

--------------------------------------------------------------------
I tried an internal modem,                    <A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A>
     but it hurt when I walked.                          Mark Newton
----- Voice: +61-4-1620-2223 ------------- Fax: +61-8-82231777 -----

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
