<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Squid and accountability" -->
<!-- FromName="Darryl Ross" -->
<!-- FromEmail="dross@syc.asn.au" -->
<!-- ToName="Mark Newton" <newton@atdot.dotat.org>, "Sam Silvester" -->
<!-- ToEmail="newton@atdot.dotat.org" -->
<!-- Date="Fri, 26 May 2000 15:29:35 +0930" -->
<!-- Id="02b501bfc6d7$924dbe20$050ba8c0@syc.asn.au" -->
<!-- Reference="392CC2C2.41AB481A@rebel.net.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Squid and accountability</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Darryl Ross &lt;<I><A HREF="mailto:dross@syc.asn.au">dross@syc.asn.au</A></I>&gt;
  To  : Mark Newton" &lt;newton@atdot.dotat.org&gt;, "Sam Silvester &lt;<I><A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A></I>&gt;
  Date: Fri, 26 May 2000 15:29:35 +0930
</PRE>
<H1>Re: Squid and accountability</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
----- Original Message -----
From: "Mark Newton" &lt;<A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A>&gt;
To: "Sam Silvester" &lt;<A HREF="mailto:sam@quadlink.pineview.net">sam@quadlink.pineview.net</A>&gt;
Cc: "lloy0076" &lt;<A HREF="mailto:lloy0076@rebel.net.au">lloy0076@rebel.net.au</A>&gt;; "LinuxSA Mailing List"
&lt;<A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>&gt;
Sent: Thursday, May 25, 2000 11:26 PM
Subject: Re: Squid and accountability


&gt; On Thu, May 25, 2000 at 08:10:07PM +0930, Sam Silvester wrote:
&gt;
&gt;  &gt; As a result, I have no idea which user is responsible for the
astronomical
&gt;  &gt; use of the Internet over the past month (like about 600% higher than
last
&gt;  &gt; month). As a result, I just want to be able to keep track of who is
using
&gt;  &gt; how much in order to ensure responsible use.
&gt;
&gt; Squid supports HTTP proxy-auth.  If a user authenticates to the proxy,
&gt; log messages will contain their username from that point onwards;  it's
&gt; very trivial to write a bit of perl which summarizes usage on a per-user
&gt; basis.  Look up proxy authentication in the Squid manual for all the
&gt; good bits.
&gt;

Here at work, I use calamaris to generate a report on our squid usage. By
default it shows a summary for the total traffic transferred by each host
that uses it. It can even show you every single top level and second level
domain that is viewed. As well as hit rates for each client, etc. I run it
weekly from crontab like such:

=====  /usr/local/bin/squid-report =====
#!/bin/sh
DATE=`date +%Y%m%d`
cat /var/log/squid/access.log | calamaris -d -1  -r -1 -t 5 -w  \
    &gt; /root/squid-logs/$DATE.html
=============================

If you want to check what sites a particular person is accessing, just
change it to the following:

=====  /usr/local/bin/squid-report-individual =====
#!/bin/sh
DATE=`date +%Y%m%d`
IP=$1
cat /var/log/squid/access.log | grep $IP | calamaris -d -1  -r -1 -t 5 -w  \
    &gt; /root/squid-logs/$DATE-$IP.html
====================================

And it will generate a full report on the IP address that is passed to the
script. If you need the calamaris RPM email me and I can send it to you.

Darryl

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
