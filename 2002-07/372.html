<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Masquerading / FTP Server" -->
<!-- FromName="'Steve Lawrence'" -->
<!-- FromEmail="sjl79@netspace.net.au" -->
<!-- ToName="'LinuxSA'" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Mon, 15 Jul 2002 00:40:31 +0930" -->
<!-- Id="000501c22b48$9b8ca280$25aafea9@sjl" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Masquerading / FTP Server</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Steve Lawrence &lt;<I><A HREF="mailto:sjl79@netspace.net.au">sjl79@netspace.net.au</A></I>&gt;
  To  : LinuxSA &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Mon, 15 Jul 2002 00:40:31 +0930
</PRE>
<H1>Masquerading / FTP Server</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Hi guys,

I've been trying to sort out my firewall script so that my Linux box will
forward the incoming connections on the FTP port for the server on my
windows box to my windows box.

I've presently got what i believe to be a partial success in that connection
attempts are no longer being snuffed out by the firewall however they seem
not to be being picked up by the FTP. I have verified that the connection
attempt at least seems to be being forwarded (through the use of ethereal)

<A HREF="http://www.ethereal.com">http://www.ethereal.com</A>

TCP Source Port: 4560, DST Port XXXX (XXXX), SEQ:2059763647, ACK:0, LEN:0.

This is pretty much the result of listening to the packets which are being
received on the windows box NIC, noting that there is no acknowledgement of
the packet and yes this is definitely as a result of the FTP connection
attempt, as was determined by the source and dest addresses for the
proceedure (not shown).

So basically what i'm asking after all of that is, can anyone help me out
with the actual IPTABLES chains i need to enable this to work ?

this is as close i've managed to get :

$IPTABLES -A PREROUTING -t nat -p tcp -d $EXTIP --dport XXXX:XXXX -j
DNAT --to $HTTPIP

Noting that the port range includes the data ports for the ftp server as
well as the port and port -1 for the actual connections, so as to allow
passive mode connections.

Also where $EXTIP = dynamically assigned ip from the ISP and $HTTPIP = the
local machine which contains the FTP server

Any and all help will be more than gratefully accepted at this stage :)

thanks folks

Steve Lawrence

PS : noting i'm still a very green user of linux, though this may be
blatantly obvious by the question alone. :)


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
