<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: IP Masquerading and DNS" -->
<!-- FromName="Matthew Tippett" -->
<!-- FromEmail="matthew.tippett@dsto.defence.gov.au" -->
<!-- ToName="Don Collins" -->
<!-- ToEmail="doncol@george.mdt.net.au" -->
<!-- Date="Tue, 04 Nov 1997 11:08:12 +1030" -->
<!-- Id="345E6E74.51B3384D@dsto.defence.gov.au" -->
<!-- Reference="m0xSWiS-0009ZrC@mail.mdt.net.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: IP Masquerading and DNS</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Matthew Tippett &lt;<I><A HREF="mailto:matthew.tippett@dsto.defence.gov.au">matthew.tippett@dsto.defence.gov.au</A></I>&gt;
  To  : Don Collins &lt;<I><A HREF="mailto:doncol@george.mdt.net.au">doncol@george.mdt.net.au</A></I>&gt;
  Date: Tue, 04 Nov 1997 11:08:12 +1030
</PRE>
<H1>Re: IP Masquerading and DNS</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Don Collins wrote:
&gt; 
I haven't used the masq code myself, but...

&gt; I finally got my kernel to compile, and configured for IP Masquerading, but
&gt; have a little trouble using the masq. functions.
Aren't there always :)

&gt; I can ping through the masq. host (which I use to dial up my ISP) from a
&gt; client on the local network to any Internet address using numerical IP
&gt; addresses but not DNS entries. ie. 'ping 111.111.111.111' works, but not
&gt; 'ping machine.domainname'.  This is also the same on the masq host itself.
So that means that ICMP forwarding is working.  If DNS is not working then
it might be that you are not forwarding UDP properly.  If the clients are
using an external DNS server you might need to turn on UDP forwarding.

I would recommend that you use a caching nameserver of the masq box.  That
I think would stop any extra packets going out to the ISP, and would speed
up in queries in general.

&gt; As, a result, I get timeouts when trying to use a browser etc.   If I try a
&gt; ftp session to an external machine using a second Linux box it pauses for
&gt; 2-3 minutes before it connects.  Once connected it is fine, no noticeable
&gt; speed degradation at all.
Sounds very much like a DNS timeout.  IIRC it DNS times out after 5, 30 and then
120 seconds, at which time it sends another query.

&gt; It seems to me that some sort of DNS resolution error is occurring, but I
&gt; can't figure it out.  I have the appropriate resolv.conf entries on both
&gt; the masq. host and client machines.  I've forgotten something I'm
&gt; sure...but what?
Hopefully that fixes it.

&gt; Thanx in advance...desperate Don.
Hope this helps.

BTW Geoffrey's talk this month is on IP Masquerading.  Useful for ISP's,
small business' (big ones for that matter) and home networks.

Matt

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
