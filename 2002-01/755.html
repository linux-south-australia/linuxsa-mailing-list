<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: dead smb connections" -->
<!-- FromName="'Mike O'Connor'" -->
<!-- FromEmail="mike@pineview.net" -->
<!-- ToName="'Anthony Symons'" -->
<!-- ToEmail="ant@sa.pracom.com.au" -->
<!-- Date="Thu, 31 Jan 2002 14:30:47 +1030" -->
<!-- Id="007001c1aa0b$dd133430$1ef621cb@themaster" -->
<!-- Reference="1012440516.22218.307.camel@ant.internal" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: dead smb connections</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Mike O &lt;<I><A HREF="mailto:mike@pineview.net">mike@pineview.net</A></I>&gt;
  To  : Anthony Symons &lt;<I><A HREF="mailto:ant@sa.pracom.com.au">ant@sa.pracom.com.au</A></I>&gt;
  Date: Thu, 31 Jan 2002 14:30:47 +1030
</PRE>
<H1>Re: dead smb connections</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Hi Anthony

This is a major problem which I have been hassling over for awhile, we have
a site using X terminal which uses a smb server on each terminal to make the
floppy drive available to the user.

Some times the terminal crash, and leave the mounts on the server in a 'D'
state, when in this state they can not be killed and the only fix is to
REBOOT THE SERVER.

We have over come this to a certain extent by using automount with a very
short mount time. From our testing it would seem that automount does the
mounting in a little different manner and this seem to stop or reduce the
chance of this deadlock.

Cheers
  Mike O'Connor



----- Original Message -----
From: "Anthony Symons" &lt;<A HREF="mailto:ant@sa.pracom.com.au">ant@sa.pracom.com.au</A>&gt;
To: &lt;<A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>&gt;
Sent: Thursday, January 31, 2002 11:58 AM
Subject: dead smb connections


&gt; What are you supposed to do when you have a samba connection to a
&gt; windows box, and you are copying files and playing mp3s off of it, then
&gt; the windows box dies, and all the samba stuff stops responding? I can
&gt; kill xmms, and the processes that were doing the copying, but I get this
&gt; sort of stuff:
&gt;
&gt; [<A HREF="mailto:root@ant">root@ant</A> root]# umount -f /mnt/pharrison
&gt; umount2: Device or resource busy
&gt; umount: <A HREF="file://pharrison/music:">file://pharrison/music:</A> not found
&gt; umount: /mnt/pharrison: Illegal seek
&gt; umount2: Device or resource busy
&gt; umount: /mnt/pharrison: device is busy
&gt;
&gt; and if I do:
&gt;
&gt; [<A HREF="mailto:root@ant">root@ant</A> root]# lsof |grep pharrison
&gt;
&gt; then it just hangs there for ages presumably waiting for something to
&gt; time out. Same if I hit tab in my mnt directory as it trys to stat the
&gt; dud share or something like that.
&gt;
&gt; I cant kill the smbfs mount processes either:
&gt;
&gt; [<A HREF="mailto:root@ant">root@ant</A> root]# ps -ax |grep music
&gt;  2081 ?        D      0:00 /sbin/mount.smbfs <A HREF="file://pharrison/music">file://pharrison/music</A>
&gt; /mnt/pharrison -o
&gt;  2276 pts/8    S      0:00 grep music
&gt;
&gt; [<A HREF="mailto:root@ant">root@ant</A> root]# kill -9 2081
&gt;
&gt; [<A HREF="mailto:root@ant">root@ant</A> root]# ps -ax |grep music
&gt;  2081 ?        D      0:00 /sbin/mount.smbfs <A HREF="file://pharrison/music">file://pharrison/music</A>
&gt; /mnt/pharrison -o
&gt;  2278 pts/8    S      0:00 grep music
&gt;
&gt; So, the windows box died, I dont care about alerting it of my
&gt; disconnection or anything, and I dont care what happens to any processes
&gt; that are trying to use that share, but how do I get my box fixed so I
&gt; can reconnect the share?
&gt;
&gt; Ant
&gt;
&gt;
&gt; --
&gt; Systems Administrator
&gt; Pracom Ltd.
&gt; +61 8 82029074 -=- +61 402 100 671
&gt; <A HREF="mailto:anthony.symons@sa.pracom.com.au">anthony.symons@sa.pracom.com.au</A>
&gt;
&gt; PRIVILEGED - PRIVATE AND CONFIDENTIAL
&gt; This electronic mail is solely for the use of the addressee and may
&gt; contain information which is confidential or privileged.
&gt; If you receive this electronic mail in error, please delete it from
&gt; your system immediately and notify the sender by electronic mail or
&gt; using any of the above contact details.
&gt;
&gt; --
&gt; LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
&gt; To unsubscribe from the LinuxSA list:
&gt;   mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
