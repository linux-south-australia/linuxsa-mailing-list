<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: dead smb connections" -->
<!-- FromName="'Anthony Symons'" -->
<!-- FromEmail="ant@sa.pracom.com.au" -->
<!-- ToName="'Toby Corkindale'" -->
<!-- ToEmail="tjcorkin@sa.pracom.com.au" -->
<!-- Date="31 Jan 2002 15:02:53 +1030" -->
<!-- Id="1012451573.22218.349.camel@ant.internal" -->
<!-- Reference="Pine.LNX.4.33.0201311454420.28566-100000@localhost.localdomain" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: dead smb connections</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Anthony Symons &lt;<I><A HREF="mailto:ant@sa.pracom.com.au">ant@sa.pracom.com.au</A></I>&gt;
  To  : Toby Corkindale &lt;<I><A HREF="mailto:tjcorkin@sa.pracom.com.au">tjcorkin@sa.pracom.com.au</A></I>&gt;
  Date: 31 Jan 2002 15:02:53 +1030
</PRE>
<H1>Re: dead smb connections</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Im mounting with mount, share as listed in fstab, mounting a share on a
windows 98 box to this mandrake 8.1 box which is running samba 2.2.1a.

fstab reads:
//pharrison/music /mnt/pharrison smbfs noauto,users 0 0

And then I mount /mnt/pharrison when running as ant.

Toby: feel free to log in to my box and check!

Ant

On Thu, 2002-01-31 at 14:57, Toby Corkindale wrote:
&gt; What on earth are you guys doing?!?
&gt; 
&gt; I mount samba shares from my server at home, then turn off the pcs the
&gt; shares were on all the time.. The server realises and the next time i access
&gt; the share it pauses briefly, then gives me an error and then unmounts the
&gt; broken share.
&gt; 
&gt; I remember I had problems like you're describing sometime around the redhat
&gt; 5.x era though.
&gt; 
&gt; Examine your setup to see if you're using hard mounts (which are
&gt; non-interruptable) or particularly long timeouts somewhere?
&gt; 
&gt; Toby
&gt; 
&gt; On Thu, 31 Jan 2002, Mike O'Connor wrote:
&gt; 
&gt; &gt; Hi Anthony
&gt; &gt;
&gt; &gt; This is a major problem which I have been hassling over for awhile, we have
&gt; &gt; a site using X terminal which uses a smb server on each terminal to make the
&gt; &gt; floppy drive available to the user.
&gt; &gt;
&gt; &gt; Some times the terminal crash, and leave the mounts on the server in a 'D'
&gt; &gt; state, when in this state they can not be killed and the only fix is to
&gt; &gt; REBOOT THE SERVER.
&gt; &gt;
&gt; &gt; We have over come this to a certain extent by using automount with a very
&gt; &gt; short mount time. From our testing it would seem that automount does the
&gt; &gt; mounting in a little different manner and this seem to stop or reduce the
&gt; &gt; chance of this deadlock.
&gt; &gt;
&gt; &gt; Cheers
&gt; &gt;   Mike O'Connor
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; ----- Original Message -----
&gt; &gt; From: "Anthony Symons" &lt;<A HREF="mailto:ant@sa.pracom.com.au">ant@sa.pracom.com.au</A>&gt;
&gt; &gt; To: &lt;<A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>&gt;
&gt; &gt; Sent: Thursday, January 31, 2002 11:58 AM
&gt; &gt; Subject: dead smb connections
&gt; &gt;
&gt; &gt;
&gt; &gt; &gt; What are you supposed to do when you have a samba connection to a
&gt; &gt; &gt; windows box, and you are copying files and playing mp3s off of it, then
&gt; &gt; &gt; the windows box dies, and all the samba stuff stops responding? I can
&gt; &gt; &gt; kill xmms, and the processes that were doing the copying, but I get this
&gt; &gt; &gt; sort of stuff:
&gt; &gt; &gt;
&gt; &gt; &gt; [<A HREF="mailto:root@ant">root@ant</A> root]# umount -f /mnt/pharrison
&gt; &gt; &gt; umount2: Device or resource busy
&gt; &gt; &gt; umount: <A HREF="file://pharrison/music:">file://pharrison/music:</A> not found
&gt; &gt; &gt; umount: /mnt/pharrison: Illegal seek
&gt; &gt; &gt; umount2: Device or resource busy
&gt; &gt; &gt; umount: /mnt/pharrison: device is busy
&gt; &gt; &gt;
&gt; &gt; &gt; and if I do:
&gt; &gt; &gt;
&gt; &gt; &gt; [<A HREF="mailto:root@ant">root@ant</A> root]# lsof |grep pharrison
&gt; &gt; &gt;
&gt; &gt; &gt; then it just hangs there for ages presumably waiting for something to
&gt; &gt; &gt; time out. Same if I hit tab in my mnt directory as it trys to stat the
&gt; &gt; &gt; dud share or something like that.
&gt; &gt; &gt;
&gt; &gt; &gt; I cant kill the smbfs mount processes either:
&gt; &gt; &gt;
&gt; &gt; &gt; [<A HREF="mailto:root@ant">root@ant</A> root]# ps -ax |grep music
&gt; &gt; &gt;  2081 ?        D      0:00 /sbin/mount.smbfs <A HREF="file://pharrison/music">file://pharrison/music</A>
&gt; &gt; &gt; /mnt/pharrison -o
&gt; &gt; &gt;  2276 pts/8    S      0:00 grep music
&gt; &gt; &gt;
&gt; &gt; &gt; [<A HREF="mailto:root@ant">root@ant</A> root]# kill -9 2081
&gt; &gt; &gt;
&gt; &gt; &gt; [<A HREF="mailto:root@ant">root@ant</A> root]# ps -ax |grep music
&gt; &gt; &gt;  2081 ?        D      0:00 /sbin/mount.smbfs <A HREF="file://pharrison/music">file://pharrison/music</A>
&gt; &gt; &gt; /mnt/pharrison -o
&gt; &gt; &gt;  2278 pts/8    S      0:00 grep music
&gt; &gt; &gt;
&gt; &gt; &gt; So, the windows box died, I dont care about alerting it of my
&gt; &gt; &gt; disconnection or anything, and I dont care what happens to any processes
&gt; &gt; &gt; that are trying to use that share, but how do I get my box fixed so I
&gt; &gt; &gt; can reconnect the share?
&gt; &gt; &gt;
&gt; &gt; &gt; Ant
&gt; &gt; &gt;
&gt; &gt; &gt;
&gt; &gt; &gt; --
&gt; &gt; &gt; Systems Administrator
&gt; &gt; &gt; Pracom Ltd.
&gt; &gt; &gt; +61 8 82029074 -=- +61 402 100 671
&gt; &gt; &gt; <A HREF="mailto:anthony.symons@sa.pracom.com.au">anthony.symons@sa.pracom.com.au</A>
&gt; &gt; &gt;
&gt; &gt; &gt; PRIVILEGED - PRIVATE AND CONFIDENTIAL
&gt; &gt; &gt; This electronic mail is solely for the use of the addressee and may
&gt; &gt; &gt; contain information which is confidential or privileged.
&gt; &gt; &gt; If you receive this electronic mail in error, please delete it from
&gt; &gt; &gt; your system immediately and notify the sender by electronic mail or
&gt; &gt; &gt; using any of the above contact details.
&gt; &gt; &gt;
&gt; &gt; &gt; --
&gt; &gt; &gt; LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
&gt; &gt; &gt; To unsubscribe from the LinuxSA list:
&gt; &gt; &gt;   mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject
&gt; &gt;
&gt; &gt;
&gt; 
&gt; -- 
&gt;  Toby Corkindale
&gt;  UNIX Developer, Core Tech R&D
&gt;  Technology SA, Pracom Ltd
&gt;  288 Glen Osmond Road
&gt;  Fullarton,	5063
&gt;  South Australia
&gt;  Tel: +61 8 8202 9075
&gt;  Fax: +61 8 8202 9001
&gt;  mailto:<A HREF="mailto:Toby.Corkindale@sa.pracom.com.au">Toby.Corkindale@sa.pracom.com.au</A>
&gt;  <A HREF="http://www.sa.pracom.com.au/">http://www.sa.pracom.com.au/</A>
&gt; 
&gt;                   PRIVILEGED - PRIVATE AND CONFIDENTIAL
&gt; 
&gt;    Privileged/Confidential Information may be contained in this message.
&gt;    If you are not the addressee indicated in this message, you may not
&gt;    copy or deliver this message to anyone.  In such case, you should
&gt;    destroy this message and notify the sender by reply email. Opinions,
&gt;    conclusions and other information in this message that do not relate
&gt;    to the official business of this organisation shall be understood as
&gt;    neither given nor endorsed by it.
&gt; 
-- 
Systems Administrator       
Pracom Ltd.             
+61 8 82029074 -=- +61 402 100 671 
<A HREF="mailto:anthony.symons@sa.pracom.com.au">anthony.symons@sa.pracom.com.au</A>

PRIVILEGED - PRIVATE AND CONFIDENTIAL
This electronic mail is solely for the use of the addressee and may
contain information which is confidential or privileged.
If you receive this electronic mail in error, please delete it from
your system immediately and notify the sender by electronic mail or
using any of the above contact details.

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
