<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE: Secure Apache VirtualHost" -->
<!-- FromName="'Brad Wilson'" -->
<!-- FromEmail="brad.wilson@mnetcorporation.com" -->
<!-- ToName="" -->
<!-- ToEmail="regenerate@hush.com,linuxsa@linuxsa.org.au" -->
<!-- Date="Tue, 22 Jul 2003 09:11:39 +0930" -->
<!-- Id="10E7ECBF04FBE344BE0C12C02D9CAFC61C8D75@mnet01.mnet.local" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE: Secure Apache VirtualHost</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Brad Wilson &lt;<I><A HREF="mailto:brad.wilson@mnetcorporation.com">brad.wilson@mnetcorporation.com</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:regenerate@hush.com">regenerate@hush.com</A></I>&gt;<BR>        &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Tue, 22 Jul 2003 09:11:39 +0930
</PRE>
<H1>RE: Secure Apache VirtualHost</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
I got around this same problem once before by adding the user "httpd" to
each user's default group.  Since the users are not in any group
together but the httpd user is part of *every* user group, httpd can see
the users files but the users cannot see eachother's files (assuming
permissions are 750 on user files). 

So, my /etc/group file looked something like this:

joe:x:1001:httpd
bob:x:1002:httpd
Jim:x:1003:httpd
Etc,etc

It's a bit messy for 200+ users, but you could write a script which
takes care of it quite easily.

Cheers,
Brad


Brad Wilson - Wireless Applications Manager, Gallery 4 
m.Net Corporation , tel: +61 8 8210 2029, mob: 0418 848 275


-----Original Message-----
From: <A HREF="mailto:regenerate@hush.com">regenerate@hush.com</A> [mailto:<A HREF="mailto:regenerate@hush.com">regenerate@hush.com</A>] 
Sent: Tuesday, 22 July 2003 1:03 AM
To: <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>
Cc: <A HREF="mailto:users@httpd.apache.org">users@httpd.apache.org</A>
Subject: Secure Apache VirtualHost



Hi lists,
I'm trying to setup a basic web hosting server for use with 200+ sites.
I've done the usual setup of mail+ftp+apache+mysql, with proftpd
configured with chroots to each "virtual site"'s root, so users can't
browse through to other people's hosted sites.

Directory structure is /home/hosting/www.sitehere.com/www
Every site has its own group, every user is part of this group

Problem though -- apache runs as user 'httpd', which requires every site
to have read-all access.  Even though every user on the system has a
false shell set, so they can't ssh/telnet in, it means anybody who has a
reasonably basic knowledge of php or perl to write a simple script to
list and show files in other directories they have read access to
- which are other people's sites!

Seeing as most sites these days are database driven it potentionally
means that they could view another site's php/perl source, where the
username, password, and database are defined.  They could then write
their own script to modify that database directly!

Surely there's some way to stop users in an apache 'virtual host' from
being able to view other hosted site's files?

Ideas?

Thanks




Concerned about your privacy? Follow this link to get
FREE encrypted email: https://www.hushmail.com/?l=2

Free, ultra-private instant messaging with Hush Messenger
https://www.hushmail.com/services.php?subloc=messenger&l=434

Promote security and make money with the Hushmail Affiliate Program: 
https://www.hushmail.com/about.php?subloc=affiliate&l=427

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on
irc.freenode.net To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
