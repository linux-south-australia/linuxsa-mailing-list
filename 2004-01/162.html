<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Multiply Ethernet links, default gateways and IP spoof protection" -->
<!-- FromName="'Richard Sharpe'" -->
<!-- FromEmail="rsharpe@richardsharpe.com" -->
<!-- ToName="'Mike O'Connor'" -->
<!-- ToEmail="mike@pineview.net" -->
<!-- Date="Sun, 4 Jan 2004 18:22:06 -0800 (PST)" -->
<!-- Id="Pine.LNX.4.44.0401041820150.4390-100000@durable" -->
<!-- Reference="000d01c3d326$c4f2a480$1ef621cb@themaster" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Multiply Ethernet links, default gateways and IP spoof protection</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Richard Sharpe &lt;<I><A HREF="mailto:rsharpe@richardsharpe.com">rsharpe@richardsharpe.com</A></I>&gt;
  To  : Mike O &lt;<I><A HREF="mailto:mike@pineview.net">mike@pineview.net</A></I>&gt;
  Date: Sun, 4 Jan 2004 18:22:06 -0800 (PST)
</PRE>
<H1>Re: Multiply Ethernet links, default gateways and IP spoof protection</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Mon, 5 Jan 2004, Mike O'Connor wrote:

&gt; Hi All
&gt; 
&gt; I have a box at a local large ISP in Adelaide which I maintain, this machine
&gt; was installed some time back with just enough ip address for host and
&gt; gateway(/30).
&gt; It now has about 400 domains hosted and is the primary DNS for these.
&gt; 
&gt; As a part of an upgrade I used the Linux vserver patches to allow the
&gt; running of multiply server on this hardware. This would allow me to develop
&gt; a new set of server with out affecting the current one which is in a bad
&gt; way.
&gt; Problem is that vservers need a different ip address per vserver, so I
&gt; needed more ip address's
&gt; 
&gt; It turned out that we could only get ip address via a new Ethernet cable.
&gt; (This is just how it is)
&gt; 
&gt; Some information change to hide the identity of all other than me. :)
&gt; 
&gt; Net1: 192.168.1.0/30:
&gt;     Host: 192.168.1.1
&gt;     Gateway: 192.168.1.2
&gt; 
&gt; Net2: 172.29.1.0/29:
&gt;     Host: 172.29.1.1-5
&gt;     Gateway: 172.29.1.6
&gt; 
&gt; 
&gt; Now here is the problem:
&gt; 
&gt; If a packet comes in on Net1 to 192.168.1.1 and the gateway is set to net2
&gt; the packets will not get to the requester.
&gt; The problem comes down to one of two things
&gt; 1. Linux sends its packets out with the ip address of the closest gateway in
&gt; this case net2 even if the service is bound to the net1 interface.
&gt; 2. The packet gets block because the ISP has packet spoofing enable.
&gt; 
&gt; At this time I have not been able to working which of the following is the
&gt; problem.

Modern versions of Linux capture outgoing packets on a link after all 
address transformations have been done, so tcpdump should be able to tell 
you exactly what outgoing addresses are on all packets going out each 
interface.

A little work with Ethereal should tell you what the problem is after you 
have captures from each interface and have launched a request that fails 
at the server.

Regards
-----
Richard Sharpe, rsharpe[at]ns.aus.com, rsharpe[at]samba.org, 
sharpe[at]ethereal.com, <A HREF="http://www.richardsharpe.com">http://www.richardsharpe.com</A>

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
