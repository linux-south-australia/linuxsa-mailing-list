<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: new idea ( ??)" -->
<!-- FromName="" -->
<!-- FromEmail="dan@shearer.org" -->
<!-- ToName="Linux SA" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Sat, 12 Aug 2000 21:15:39 +0930 (CST)" -->
<!-- Id="Pine.LNX.4.10.10008122105220.31716-100000@localhost.localdomain" -->
<!-- Reference="3.0.6.32.20000812141803.00a43790@203.16.214.248" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: new idea ( ??)</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: <A HREF="mailto:dan@shearer.org">dan@shearer.org</A>
  To  : Linux SA &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Sat, 12 Aug 2000 21:15:39 +0930 (CST)
</PRE>
<H1>Re: new idea ( ??)</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Sat, 12 Aug 2000, Richard Sharpe wrote:

&gt; At 12:50 PM 8/12/00 +0930, Dan Shearer wrote:
&gt; &gt;On Sat, 12 Aug 2000, Daryl Tester wrote:
&gt; &gt;
&gt; &gt;&gt; Stephen Donaldson wrote:
&gt; &gt;&gt; 
&gt; &gt;&gt; &gt; I would suggest that, given the limited
&gt; &gt;&gt; &gt; input so far, you identify the most commonly used files and cron them
&gt; &gt;&gt; &gt; regularly..
&gt; &gt;&gt; 
&gt; &gt;&gt; I think you need to re-read the question.  It was a single file
&gt; &gt;&gt; of 2 gig in size.
&gt; &gt;&gt; 
&gt; &gt;&gt; I have done something in a commercial environment for a relatively
&gt; &gt;&gt; large file, which involves:
&gt; &gt;&gt; 
&gt; &gt;&gt; 1)  Running the transaction file on a mirrored drive.
&gt; &gt;&gt; 2)  Breaking the mirror (to get a "reasonably consistent snapshot).
&gt; &gt;&gt; 3)  Backing up the non-used ex mirror.
&gt; &gt;&gt; 4)  Merging the drive back with its original mirror.
&gt; &gt;&gt; 
&gt; &gt;&gt; Steps 2-4 are performed every 15 minutes.  Works OK, but probably not
&gt; &gt;&gt; for 2 gigs of data.
&gt; &gt;
&gt; &gt;A more efficient way to do steps 2-4 is to use rsync,
&gt; &gt;<A HREF="http://rsync.samba.org.">http://rsync.samba.org.</A>
&gt; 
&gt; Well, that depends. At a site I am involved with, we currently rsync about
&gt; 5GB of data between two machines every 20 minutes. It chews up so much CPU
&gt; that users notice it. 

Yes. The rsync algorithm is expensive in CPU but not bandwidth, but the
opposite might easily apply in this case depending on various cases. It
also is quite unnecessary, because there is no barrier to comparing the
two files. 

There really isn't any clever algorithm needed. There are various ways of
patching one binary file to be up to date with another, especially when
the relative differences are small. rsync is perfect when it is impossible
to compare the two files.

&gt; The problem is it has to check every file in that 5GB
&gt; or so worth of data.

No. I think you'll find that the problem is that rsync involves a lot of
checksum calculations. Any mirroring method will require checking each
file, but there are plenty of ways of mirroring files when you have access
to both of them on one machine that don't involve much calculation at all.
So while a non-rsync solution might still give you an unacceptable window
of potential loss, it should be very much smaller under these
circumstances.

&gt; In addition, loosing up to 20 minutes worth of data, and the
&gt; inconsistencies between the two sets is not a good thing.

Yes. If the data is worth a lot or the change rate is high, and there is a
budget for quite a bit of fiddling around then you should certainly do
something other than rsync.

&gt; &gt;There are ways of doing this sort of thing at the filesystem level and
&gt; &gt;also at the disc block level. Neither are trivial to set up. rsync is a
&gt; &gt;good interim, simple solution.
&gt; 
&gt; So, we are looking at using drbd, which is one of the solutions I imagine
&gt; Dan is talking about.

Yes. Solutions range from VERITAS through to a cute thing BSD has whose
name I can't remember right now involving a way of mirroring all writes to
a disc device over a network without anything at higher levels knowing.
Mature free solutions are scarce, but there is a lot of work being done in
this area, some of it designed for Linux 2.4.

Dan

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
