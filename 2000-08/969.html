<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: PGP ADK detection" -->
<!-- FromName="Alan Kennington" -->
<!-- FromEmail="akenning@dog.topology.org" -->
<!-- ToName="Jake Hawkes" -->
<!-- ToEmail="jake@infinitylimited.net" -->
<!-- Date="Tue, 29 Aug 2000 13:37:28 +0930" -->
<!-- Id="20000829133728.A26232@dog.topology.org" -->
<!-- Reference="39AB2C37.C789F1BD@infinitylimited.net" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: PGP ADK detection</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Alan Kennington &lt;<I><A HREF="mailto:akenning@dog.topology.org">akenning@dog.topology.org</A></I>&gt;
  To  : Jake Hawkes &lt;<I><A HREF="mailto:jake@infinitylimited.net">jake@infinitylimited.net</A></I>&gt;
  Date: Tue, 29 Aug 2000 13:37:28 +0930
</PRE>
<H1>Re: PGP ADK detection</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Mon, Aug 28, 2000 at 09:21:27PM -0600, Jake Hawkes wrote:
&gt; Alan Kennington wrote:
&gt; &gt; 
&gt; &gt; I think that the ADK can be added to a public public-key,
&gt; 
&gt; Hmmm, your middle name doesn't start with `D' does it Alan?

No, but seriously though, one Phil Nitschke did reply to me
with the answer to my query.
Namely, one should download GnuPG and run

gpg --list-packets &lt;filename&gt;

to get output such as this for a public key:

----------------------------------------------------------
:public key packet:
        version 4, algo 17, created 920459464, expires 0
        pkey[0]: [1024 bits]
        pkey[1]: [160 bits]
        pkey[2]: [1023 bits]
        pkey[3]: [1021 bits]
:user ID packet: "Alan Kennington &lt;<A HREF="mailto:akenning@dog.topology.org">akenning@dog.topology.org</A>&gt;"
:signature packet: algo 17, keyid 7D56121BD363329E
        version 4, created 920459464, md5len 0, sigclass 10
        digest algo 2, begin of digest c6 82
        hashed subpkt 2 len 5 (sig created 1999-03-03)
        hashed subpkt 11 len 4 (pref-sym-algos: 3 1 2)
        subpkt 16 len 9 (issuer key ID 7D56121BD363329E)
        data: [155 bits]
        data: [158 bits]
:public sub key packet:
        version 4, algo 16, created 920459465, expires 0
        pkey[0]: [2048 bits]
        pkey[1]: [2 bits]
        pkey[2]: [2047 bits]
:signature packet: algo 17, keyid 7D56121BD363329E
        version 3, created 920459466, md5len 5, sigclass 18
        digest algo 2, begin of digest ee c5
        data: [160 bits]
        data: [160 bits]
:public key packet:
        version 3, algo 1, created 946284437, expires 0
        pkey[0]: [2048 bits]
        pkey[1]: [5 bits]
:user ID packet: "Alan Kennington &lt;<A HREF="mailto:akenning@dog.topology.org">akenning@dog.topology.org</A>&gt;"
:signature packet: algo 1, keyid 2697AC4FEF1D8CBD
        version 3, created 946284437, md5len 5, sigclass 10
        digest algo 1, begin of digest 49 09
        data: [2048 bits] 
----------------------------------------------------------

I was quite hypothetical-entity-smacked when I saw this.
At last, a way to look into all that mangle that PGP
produces. It even works on e-mail messages that are encrypted,
and shows anything dodgy that might in there, and a list
of who the message was encrypted to.

Apparently a dodgy ADK shows up as something like:

  subpkt 10 len 23 (additional recipient request)

instead of:

  hashed subpkt 10 len 23 (additional recipient request)

It's all very simple really!

E.g. this message was encrypted to two people:

---------------------------------------------------------
:marker packet:
 50 47 50
:pubkey enc packet: version 3, algo 16, keyid 1E83703F6ABD9043
        data: [2047 bits]
        data: [2046 bits]
:pubkey enc packet: version 3, algo 16, keyid 37CA79782F70BCC9
        data: [2048 bits]
        data: [2047 bits]
:encrypted data packet:
        length: 340
gpg: encrypted with ELG-E key, ID 2F70BCC9
gpg: no secret key for decryption available
gpg: encrypted with ELG-E key, ID 6ABD9043
gpg: no secret key for decryption available
gpg: decryption failed: secret key not available
----------------------------------------------------------

So in future, I can work out if the sender's message has been
compromised! 

Cheers,
Alan Kennington.

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
