<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Linux password expirations and Samba" -->
<!-- FromName="James B Curry" -->
<!-- FromEmail="jbcurry@hline.localhealth.net" -->
<!-- ToName="Richard Sharpe" -->
<!-- ToEmail="sharpe@ns.aus.com" -->
<!-- Date="Mon, 14 Aug 2000 15:03:29 -0400" -->
<!-- Id="39984280.B496F9CC@hline.localhealth.net" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Linux password expirations and Samba</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: James B Curry &lt;<I><A HREF="mailto:jbcurry@hline.localhealth.net">jbcurry@hline.localhealth.net</A></I>&gt;
  To  : Richard Sharpe &lt;<I><A HREF="mailto:sharpe@ns.aus.com">sharpe@ns.aus.com</A></I>&gt;
  Date: Mon, 14 Aug 2000 15:03:29 -0400
</PRE>
<H1>Re: Linux password expirations and Samba</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>

--------------4545D5BB4625408B32B64062
Content-Type: text/plain; charset=us-ascii
Content-Transfer-Encoding: 7bit

Whoah!  A funny thing happened to my e-mail on the way to the forum...
Let me try posting this again...

Many thanks for responding, Richard! I have attached a copy of our
smb.conf file so that you can get a better idea of
our system settings.

I have the book "SAMS Teach Yourself Samba in 24 Hours", and have found
it to be very useful as we've been
setting up our Samba server.  I am glad to have reached you - I'd think
you're just the person to indicate whether or
not password aging is possible with Samba.

Responding to your question "what happens when the Windows NT password
expires", I do not have first-hand
knowledge of whether a password expiration on NT will initiate a
dialogue to change the password when a Win9x
client logs in, but have been told that NT will.  If this assumption is
incorrect, that would certainly explain why the
Linux/Samba combo is also unable to force a password change!  I would
again be surprised, though - why would
Microsoft put a password expiration variable in NT user accounts and not
bother to support it for Win9x clients?  This
would be inconsistent with their Zero Administration Initiative.  (On
second thought, maybe that wouldn't surprise
me...)

Since I originally asked my question, I have gone back to thoroughly
test password synchronization on our server, and
noticed a problem.  Changing the Windows password from the Win9x client
changes the smbpasswd file properly;
however, the Unix password is not updated, even though I have unix
password sync = yes.  Do you see anything in
our smb.conf file that explains this?  Is this why the expiration of a
Unix password on our server doesn't prompt a
Win9x client to change their password?

In the SAMS book, PAM is discussed as a method to let the Unix password
changes sync the Unix passwd with
smbpasswd.  Would using PAM also help in initiating a "change password"
dialogue when the Unix password
expires?

Now I'm back to the original question (that I'm afraid I already know
the answer to):  Does Samba actually support
initiating a "change password" dialogue for a Win9x client at logon if
the Unix password has expired?

I appreciate your help, and look forward to hearing from you again.

Jim Curry



--------------4545D5BB4625408B32B64062
Content-Type: text/html; charset=us-ascii
Content-Transfer-Encoding: 7bit

&lt;!doctype html public "-//w3c//dtd html 4.0 transitional//en"&gt;
&lt;html&gt;
&lt;i&gt;Whoah!&nbsp; A funny thing happened to my e-mail on the way to the forum...&lt;/i&gt;
&lt;br&gt;&lt;i&gt;Let me try posting this again...&lt;/i&gt;
&lt;p&gt;Many thanks for responding, Richard! I have attached a copy of our smb.conf
file so that you can get a better idea of
&lt;br&gt;our system settings.
&lt;p&gt;I have the book "SAMS Teach Yourself Samba in 24 Hours", and have found
it to be very useful as we've been
&lt;br&gt;setting up our Samba server.&nbsp; I am glad to have reached you -
I'd think you're just the person to indicate whether or
&lt;br&gt;not password aging is possible with Samba.
&lt;p&gt;Responding to your question "what happens when the Windows NT password
expires", I do not have first-hand
&lt;br&gt;knowledge of whether a password expiration on NT will initiate a dialogue
to change the password when a Win9x
&lt;br&gt;client logs in, but have been told that NT will.&nbsp; If this assumption
is incorrect, that would certainly explain why the
&lt;br&gt;Linux/Samba combo is also unable to force a password change!&nbsp;
I would again be surprised, though - why would
&lt;br&gt;Microsoft put a password expiration variable in NT user accounts and
not bother to support it for Win9x clients?&nbsp; This
&lt;br&gt;would be inconsistent with their Zero Administration Initiative.&nbsp;
(On second thought, maybe that wouldn't surprise
&lt;br&gt;me...)
&lt;p&gt;Since I originally asked my question, I have gone back to thoroughly
test password synchronization on our server, and
&lt;br&gt;noticed a problem.&nbsp; Changing the Windows password from the Win9x
client changes the smbpasswd file properly;
&lt;br&gt;however, the Unix password is not updated, even though I have unix
password sync = yes.&nbsp; Do you see anything in
&lt;br&gt;our smb.conf file that explains this?&nbsp; Is this why the expiration
of a Unix password on our server doesn't prompt a
&lt;br&gt;Win9x client to change their password?
&lt;p&gt;In the SAMS book, PAM is discussed as a method to let the Unix password
changes sync the Unix passwd with
&lt;br&gt;smbpasswd.&nbsp; Would using PAM also help in initiating a "change
password" dialogue when the Unix password
&lt;br&gt;expires?
&lt;p&gt;Now I'm back to the original question (that I'm afraid I already know
the answer to):&nbsp; Does Samba actually support
&lt;br&gt;initiating a "change password" dialogue for a Win9x client at logon
if the Unix password has expired?
&lt;p&gt;I appreciate your help, and look forward to hearing from you again.
&lt;p&gt;Jim Curry
&lt;br&gt;&nbsp;
&lt;br&gt;&nbsp;&lt;/html&gt;

--------------4545D5BB4625408B32B64062--

#======================= Global Settings =====================================
[global]

# workgroup = NT-Domain-Name or Workgroup-Name
   workgroup = wupdhd

# server string is the equivalent of the NT Description field
   server string = Samba Server lrh1

# if you want to automatically load your printer list rather
# than setting them up individually then you'll need this
   printcap name = /etc/printcap
   load printers = yes

# Uncomment this if you want a guest account, you must add this to /etc/passwd
# otherwise the user "nobody" is used
   guest account = pcguest

# this tells Samba to use a separate log file for each machine
# that connects
   log file = /var/log/samba/log.%m

# Put a capping on the size of the log files (in Kb).
   max log size = 100

# Security mode. Most people will want user level security. See
# security_level.txt for details.
   security = domain

# You may wish to use password encryption. Please read
# ENCRYPTION.txt, Win95.txt and WinNT.txt in the Samba documentation.
# Do not enable this option unless you have read those documents
  encrypt passwords = yes
  smb passwd file = /etc/smbpasswd

# The following are needed to allow password changing from Windows to
# update the Linux sytsem password also.
# NOTE: Use these with 'encrypt passwords' and 'smb passwd file' above.
# NOTE2: You do NOT need these to allow workstations to change only
#        the encrypted SMB passwords. They allow the Unix password
#        to be kept in sync with the SMB password.
  unix password sync = yes
  passwd program = /usr/bin/passwd %u
  passwd chat = \*current*UNIX*password* %o\n *New*UNIX*password* %n\n *Retype*new*UNIX*password* %n\n *passwd:*all*authentication*tokens*updated*successfully*
# The following should be no if encrypt passwords = yes
  update encrypted = no

# Most people will find that this option gives better performance.
# See speed.txt and the manual pages for details
   socket options = TCP_NODELAY SO_RCVBUF=8192 SO_SNDBUF=8192

# Browser Control Options:
# set local master to no if you don't want Samba to become a master
# browser on your network. Otherwise the normal election rules apply
   local master = yes

# OS Level determines the precedence of this server in master browser
# elections. The default value should be reasonable
   os level = 64

# Domain Master specifies Samba to be the Domain Master Browser. This
# allows Samba to collate browse lists between subnets. Don't use this
# if you already have a Windows NT domain controller doing this job
   domain master = yes 

# Preferred Master causes Samba to force a local browser election on startup
# and gives it a slightly higher chance of winning the election
   preferred master = yes

# Enable this if you want Samba to be a domain logon server for 
# Windows95 workstations. 
   domain logons = yes

# if you enable domain logons then you may want a per-machine or
# per user logon script
# run a specific logon batch file per workstation (machine)
;   logon script = %m.bat
# run a specific logon batch file per username
;   logon script = %U.bat
    logon script = logon.bat

# All NetBIOS names must be resolved to IP Addresses
# 'Name Resolve Order' allows the named resolution mechanism to be specified
# the default order is "host lmhosts wins bcast". "host" means use the unix
# system gethostbyname() function call that will use either /etc/hosts OR
# DNS or NIS depending on the settings of /etc/host.config, /etc/nsswitch.conf
# and the /etc/resolv.conf file. "host" therefore is system configuration
# dependant. This parameter is most often of use to prevent DNS lookups
# in order to resolve NetBIOS names to IP Addresses. Use with care!
# The example below excludes use of name resolution for machines that are NOT
# on the local network segment
# - OR - are not deliberately to be known via lmhosts or via WINS.
name resolve order = wins lmhosts bcast

# Windows Internet Name Serving Support Section:
# WINS Support - Tells the NMBD component of Samba to enable it's WINS Server
   wins support = yes

# DNS Proxy - tells Samba whether or not to try to resolve NetBIOS names
# via DNS nslookups. The built-in default for versions 1.9.17 is yes,
# this has been changed in version 1.9.18 to no.
   dns proxy = no 

# Case Preservation can be handy - system default is _no_
# NOTE: These can be set on a per share basis
  preserve case = yes
;  short preserve case = no
# Default case is normally upper case for all DOS files
  default case = lower
# Be very careful with case sensitivity - it can break things!
  case sensitive = no

#============================ Share Definitions ==============================
[homes]
   comment = Personal Directories
   path = %H/Files
   browseable = no
   writable = yes
   valid users = %S
   create mode = 0660
   directory mode = 0770
   locking = no

# Un-comment the following and create the netlogon directory for Domain Logons
[NETLOGON]
   comment = Network Logon Service
   path = /home/netlogon
   guest ok = yes
   public = yes
   browseable = yes
   writable = yes
   locking = no
   ;share modes = no

# NOTE: If you have a BSD-style print system there is no need to 
# specifically define each individual printer
[printers]
   comment = All Printers
   path = /var/spool/samba
   browseable = no
# Set public = yes to allow user 'guest account' to print
   guest ok = no
   writable = no
   printable = yes
   print command = lpr -h -P %p %s; rm %s
   create mode = 0700

[ADMIN]
    comment = Access to Home Directory
    path = /home
    valid users = jbcurry jwheeler
    public = no
    writable = yes
    browseable = no
    printable = no

[SHARED]
    comment = Shared Drive
    path = /home/shared
    valid users = @allusers
    public = no
    writable = yes
    browseable = no
    printable = no
    create mode = 0666
    directory mode = 0777
    force group = allusers

[DOSSOFT]
    comment = Dos Software Repository
    path = /home/dossoft
    public = no
    valid users = @allusers
    writable = yes
    browseable = yes
    printable = no

[WINSOFT]
    comment = Windows Software Repository
    path = /home/winsoft
    public = no
    valid users = @allusers
    writable = yes
    browseable = yes
    printable = no

le =é-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
