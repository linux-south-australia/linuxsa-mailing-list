<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: KaZaA Blocking (Was Re: ADSL?)" -->
<!-- FromName="'Rick Harris'" -->
<!-- FromEmail="rickharris@mightylegends.zapto.org" -->
<!-- ToName="'Ryan Verner'" -->
<!-- ToEmail="xfesty@computeraddictions.com.au" -->
<!-- Date="27 Sep 2003 09:08:42 +0930" -->
<!-- Id="1064619522.16726.35.camel@SCOOBY.localnet" -->
<!-- Reference="VA.00000cf1.0090cfa7@airnet.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: KaZaA Blocking (Was Re: ADSL?)</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Rick Harris &lt;<I><A HREF="mailto:rickharris@mightylegends.zapto.org">rickharris@mightylegends.zapto.org</A></I>&gt;
  To  : Ryan Verner &lt;<I><A HREF="mailto:xfesty@computeraddictions.com.au">xfesty@computeraddictions.com.au</A></I>&gt;
  Date: 27 Sep 2003 09:08:42 +0930
</PRE>
<H1>Re: KaZaA Blocking (Was Re: ADSL?)</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Hi Ryan,

Haven't used p2pwall before. But as far as I can tell it just implements
a couple of 'string match' rules in Iptables.
Which is necessary for Kazaa as it can run on any port.

String match will search each IP packets for a certain text string, upon
which action can be taken. eg. DROP,REJECT,ACCEPT,REDIRECT etc.
You need to patch the kernel to enable iptables' string match support.
There's a good read & RH howto located here -&gt;
<A HREF="http://www.securityfocus.com/infocus/1531">http://www.securityfocus.com/infocus/1531</A>

Or use Iptables patch-o-matic (POM) package from <A HREF="http://www.iptables.org">http://www.iptables.org</A>
if compiling from source.

Once you have it enabled & re-compiled kernel, configure iptables like
so:


$IPTABLES -A FORWARD -p tcp -m string --string X-Kazaa-Username: -j \
REJECT --reject-with tcp-reset

$IPTABLES -A FORWARD -p tcp -m string --string X-Kazaa-Network: -j \
REJECT --reject-with tcp-reset

$IPTABLES -A FORWARD -p tcp -m string --string X-Kazaa-IP: -j \
REJECT --reject-with tcp-reset

$IPTABLES -A FORWARD -p tcp -m string --string X-Kazaa-SupernodeIP: -j \
REJECT --reject-with tcp-reset


Can be a very powerful tool, presonally we use it to block Microsoft IIS
Worms.



Best regards,
Rick



On Tue, 2003-09-23 at 17:36, Ryan Verner wrote:
&gt; Hm,
&gt; 
&gt; &gt; fees (e.g. having a household full of teenagers may not be the ideal 
&gt; &gt; circumstance under which to subscribe to BigPong cable).
&gt; 
&gt; On this note, who here has had (successful) experiences in blocking KaZaA and
&gt; other f&#(@$!'ing annoying protocols/networks that just like eating up
&gt; bandwidth for no apparent reason?
&gt; 
&gt; I've got nothing against valid P2P networks (Soulseek, etc), but KaZaA and
&gt; others are evil; try and do remote ssh work on dialup while somebody else on
&gt; the same connection has it open.  Forget it.
&gt; 
&gt; I ran into this the other day:
&gt; 
&gt; <A HREF="http://www.lowth.com/p2pwall/">http://www.lowth.com/p2pwall/</A>
&gt; 
&gt; Anybody used it?  Does it only block the damn bloody annoying P2P networks but
&gt; let ones that don't like to suddenly flood your router with 90 million UDP
&gt; requests through?
&gt; 
&gt; Cheers
&gt; 
&gt; R


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
