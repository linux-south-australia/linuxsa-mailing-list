<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: corrupt rpm db/apt?" -->
<!-- FromName="'Ben Williams'" -->
<!-- FromEmail="benw@webmedia.com.au" -->
<!-- ToName="'Alex Wallis'" -->
<!-- ToEmail="awol@prepaidonline.com.au" -->
<!-- Date="Thu, 04 Sep 2003 11:38:26 +0930" -->
<!-- Id="3F569E9A.4030804@webmedia.com.au" -->
<!-- Reference="3F558C2E.C6EFE6A0@prepaidonline.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: corrupt rpm db/apt?</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Ben Williams &lt;<I><A HREF="mailto:benw@webmedia.com.au">benw@webmedia.com.au</A></I>&gt;
  To  : Alex Wallis &lt;<I><A HREF="mailto:awol@prepaidonline.com.au">awol@prepaidonline.com.au</A></I>&gt;
  Date: Thu, 04 Sep 2003 11:38:26 +0930
</PRE>
<H1>Re: corrupt rpm db/apt?</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On 3/09/2003 4:07 PM, Alex Wallis wrote:
&gt; Ben Williams wrote:
&gt; 
&gt;&gt;any ideas as to how i could get around it, short of removing X? i guess
&gt;&gt;i could just not use apt, but it's so *nice* when it's working properly!
&gt;&gt;
&gt; 
&gt; 
&gt; Redhat 8.0 shipped with a buggy rpm as they split rpmbuild into it's own
&gt; binary. The fixes for the various "hangs" it causes is at
&gt; <A HREF="http://www.rpm.org/hintskinks/repairdb/">http://www.rpm.org/hintskinks/repairdb/</A>

that's the resource i've been using to repair the DB.

&gt; To resolve ALL your problems you will need to run the following
&gt; commands...
&gt; 
&gt; rm -f /var/lib/rpm/__db* 
&gt; rpm -vv --rebuilddb 

i've done these steps after each hang. i logged the last one; if it 
would help, i can mail you the log (it's 41k, bz2).

&gt; apt-get update
&gt; apt-get install apt

i've checked that i've got the latest version of apt for this system 
that i can find.

----------------
[<A HREF="mailto:root@tigermoth">root@tigermoth</A> rpm]# rpm -q apt apt-devel
apt-0.5.5cnc6-fr0.rh80.1
apt-devel-0.5.5cnc6-fr0.rh80.1
----------------

following the trail from &lt;<A HREF="http://freshrpms.net/apt/&gt">http://freshrpms.net/apt/&gt</A>; to 
&lt;<A HREF="http://apt.freshrpms.net/&gt">http://apt.freshrpms.net/&gt</A>; to 
&lt;<A HREF="http://ftp.freshrpms.net/pub/freshrpms/redhat/8.0/apt/&gt">http://ftp.freshrpms.net/pub/freshrpms/redhat/8.0/apt/&gt</A>; tells me that 
i've got the latest version of apt and apt-devel.

&gt; Make sure you kill -9 ALL rpm and apt processes before you begin.

done.

&gt; You'll need to upgrade your apt packages (including synaptic if
&gt; installed) as well, to resolve all the conflicts, and do NOT try to do
&gt; an apt-get upgrade until upping your version of apt first.

done all that, and synaptic is not installed.

it seems that any rpm activity (with or without hangs) is leaving the 
__* lock files there in /var/lib/rpm - is this expected behaviour? i 
would have thought that, if they're lock files, they'd get removed at 
the end of a successful rpm execution.

on a whim, i tried:

----------------
[<A HREF="mailto:root@tigermoth">root@tigermoth</A> rpm]# apt-get install XFree86
Reading Package Lists... Done
Building Dependency Tree... Done
Package XFree86 has no available version, but exists in the database.
This typically means that the package was mentioned in a dependency and
never uploaded, has been obsoleted or is not available with the contents
of sources.list
E: Package XFree86 has no installation candidate
----------------

no installation candidate, eh? interesting.

my googling for "apt rpm override", as David suggested, goes on. nothing 
relevant yet.

thanks for your help ;-)

  - Ben
--
"Everybody generalizes from one example. At least, I do."
  - Steven Brust [dreamcafe.com]

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
