<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: New RPM (warning)" -->
<!-- FromName="David Newall" -->
<!-- FromEmail="davidn@rebel.net.au" -->
<!-- ToName="linuxsa" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Thu, 21 Sep 2000 00:23:32 +0930 (CST)" -->
<!-- Id="Pine.BSF.4.21.0009202338480.86713-100000@augustus.tellurian.com.au" -->
<!-- Reference="00092022414801.01077@kanga.roo" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: New RPM (warning)</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: David Newall &lt;<I><A HREF="mailto:davidn@rebel.net.au">davidn@rebel.net.au</A></I>&gt;
  To  : linuxsa &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Thu, 21 Sep 2000 00:23:32 +0930 (CST)
</PRE>
<H1>Re: New RPM (warning)</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Don't laugh.  What follows is the true hackers tutorial to building an rpm
when you don't have rpm.  Follow closely, I'm going to go quickly and I
won't explain this again.

Let me add that this stuff is for gurus and guru-wannabies.  Kiddies: do
not try this at home.  Remember that the demonstrators are trained for this
sort of stuff.

   $ file ppp-2.3.3-4.src.rpm
   ppp-2.3.3-4.src.rpm: RPM v3 src i386 ppp-2.3.3-4

Take your rpm file and edit it using your favourite *binary enabled*
editor:

   $ vi ppp-2.3.3-4.src.rpm
   í«îÛ^C^@^@^A^@^Appp-2.3.3-4^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@
   ^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^@^A^@^E^@^
   ^@^@^@^@^@^@^@^@^@~N­è^A^@^@^@^@^@^@^@^C^@^@^@¬^@^@^Cè^@^@^@^D^@^@^@^@
   ^@^Cê^@^@^@^G^@^@^@^D^@^@^@~X^@^@^Cì^@^@^@^G^@^@^@~\^@^@^@^P^@^L*m~I^@~U

Skip past this stuff, and past the RPM description...

   ^H^@^@^L4^@^@^@^Gppp^@2.3.3^@4^@ppp daemon package for linux 1.3.xx             @ppp-D&auml;monpaket f&uuml;r Linux 1.3.xx und h&ouml;her^@Paquetage du démon ppp p
   3.xx et supérieur^@PPP sunucu s&uuml;reci^@This is the daemon and documen
   PP support.  It requires a kernel^M
   greater than 2.0 which is built with PPP support. The default Red Hat^M
   kernels include PPP support as a module.^@Dies ist der D&auml;mon und die Do
   on f&uuml;r PPP-Support. Erfordert^M
   einen Kernel h&ouml;her als 2.0, der mit PPP-Support gebaut ist. Die Stand           
until you get to the start of the gzipped cpio <A HREF="file:">file:</A>

   - fixed the PAM support, which was really, completely broken and a
   standards (session support is still not here... :-( )^M
   - we build against running kernel and pray that it will work^M
   - added a samples patch; updated glibc patch^@- added a patch to
   te.h, rather then glibc's (which has
   alignment problems on Alpha's) -- I only applied this patch on tho
   though it should be safe everywhere^@- turned off the execute bit for
   in /usr/doc^@- built against glibc^@- Integrated new patch from David
   - Improved description^@porky.redhat.com 893398459^@^@^@^@^@^H^S^@^@^H
   ^@^@^H^S^@^@^H^S^@^@^H^S^@^@^H^S^@^A~P~B^@^A~P¥^@^A~P£^@^A~P¨^
   ~A^@^@^@^@^@^@^@^_~K^H^@^@^@^@^@^B^Cì;isã6²óUú^U^X{^

Notice the ^_~K (CTRL/_ followed by K with high bit set) in the last line
above.  That's what you are looking for.  Delete everything before it and
save to a temporary file.

   ^_~K^H^[[5C@^@^@^B^Cì;isã6²óUú^U^X{^NÝ^Gu[Ñl^TÙ3vâ«,9ÙÔ$Å¥IHâ
   ÇÙd«ÞV=~U-^^è^Fº^[}¡^A5z~M^£Ùh4~Z~CF_~Ck£&szlig;4Ú~Mí~_f«}Ó2µ¦I^O
   j­êÂ±oÌ~ZoDæòUµZeIK^]î¬zø^XV^]Û~M^_jf~<A HREF="mailto:M@s">M@s</A>³~X³Cn2­Å^Zí~CÎà@ë±æ
   =@:h^Q^?ÿí·¬Ú^ZTº¬^L&szlig;}&ouml;í·y¶o»¦^S[~\}37ÝÈ&copy;-?¤&szlig;~YÑ£Ï7ÞE&lt;XÙ^~HoË
   .ò¬^b³¥^]2&uuml;s^Y¼·ø~]mÂ^@5vìÝó;^^TX~D^@¦·òm~G³{ÛqØ&Uuml;°^]¶²C^^^X7Î
   ±ÈcjÌT§ì~F~[F^\rfGli~D,ôØÊp^_YÀç&lt;à®ÉC^R~H&Ouml;^^Tz¬¬u~Z ^X^TI~^Ýy
   «8x^X^E±^Y^A)^Aÿ^M¿~GÈ^[´^C^?Æ-g~Vwï^B#pC¤`C~]ÆjkZeÀÊm­~U^]Ë^                   

The file is a gzipped cpio <A HREF="file:">file:</A>

   $ file tempfile
   temp<A HREF="file:">file:</A> gzip compressed data, deflated

Uncompress it to produce the CPIO archive:

   $ gzip &lt; tempfile &gt; tempfile2
   gunzip: stdin: unexpected end of file

   $ file tempfile2
   tempfile2: ASCII cpio archive (SVR4 with no CRC)

Extract to a new directory:

   $ mkdir extractdir
   $ cd extractdir
   $ cpio -iv &lt; ../tempfile2
   ppp-2.3.3-glibc.patch
   ppp-2.3.3-make.patch
   ppp-2.3.3-pam.patch
   ppp-2.3.3-pamd.conf
   ppp-2.3.3-sample.patch
   ppp-2.3.3.tar.gz
   pppd.spec

The .tar.gz file is the original distribution.

   $ tar xfz ppp-2.3.3.tar.gz

The .spec file contains details on the contents, and how to patch, build
and install.

Contents:

   Source0: <A HREF="ftp://cs.anu.edu.au/pub/software/ppp/ppp-2.3.3.tar.gz">ftp://cs.anu.edu.au/pub/software/ppp/ppp-2.3.3.tar.gz</A>
   Source1: ppp-2.3.3-pamd.conf
   Patch0: ppp-2.3.3-make.patch
   Patch1: ppp-2.3.3-pam.patch
   Patch2: ppp-2.3.3-sample.patch
   Patch3: ppp-2.3.3-glibc.patch

Patch instructions:

   %setup
   %patch0 -p1 -b .make
   %patch1 -p1 -b .pam
   %patch2 -p1 -b .sample
   %patch3 -p1 -b .glibc
   find . -type f -name "*.sample" | xargs rm -f

which you execute thus:

   $ patch -p1 -b .make &lt; ppp-2.3.3-make.patch
   $ patch -p1 -b .pam &lt; ppp-2.3.3-pam.patch
   $ patch -p1 -b .sample &lt; ppp-2.3.3-sample.patch
   $ patch -p1 -b .glibc &lt; ppp-2.3.3-glibc.patch
   $ find . -type f -name "*.sample" | xargs rm -f

Build instructions:

   %build
   ./configure
   make RPM_OPT_FLAGS="$RPM_OPT_FLAGS"

Which you can work out how to execute for yourself.  Installation
instructions are equally obvious.

Enjoy.

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
