<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE: Transparent Proxying" -->
<!-- FromName="'Richard Russell'" -->
<!-- FromEmail="richard@yellowgoanna.com" -->
<!-- ToName="'Mark Newton','Martin Sandiford'" -->
<!-- ToEmail="newton@atdot.dotat.org,ms@mcdev.com.au" -->
<!-- Date="Tue, 26 Mar 2002 14:49:35 -0800" -->
<!-- Id="000801c1d518$80a28330$1200a8c0@skink" -->
<!-- Reference="20020326091106.A38912@atdot.dotat.org" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE: Transparent Proxying</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Richard Russell &lt;<I><A HREF="mailto:richard@yellowgoanna.com">richard@yellowgoanna.com</A></I>&gt;
  To  : Mark Newton &lt;<I><A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A></I>&gt;<BR>        Martin Sandiford &lt;<I><A HREF="mailto:ms@mcdev.com.au">ms@mcdev.com.au</A></I>&gt;
  Date: Tue, 26 Mar 2002 14:49:35 -0800
</PRE>
<H1>RE: Transparent Proxying</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
&gt; On Tue, Mar 26, 2002 at 01:44:09AM +1030, Martin Sandiford wrote:
&gt; 
&gt;  &gt; On Tue, 26 Mar 2002, <A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A> wrote:
&gt;  &gt; &gt; On Mon, Mar 25, 2002 at 09:13:47PM -0800, Richard 
&gt; Russell wrote:  &gt; &gt; 
&gt;  &gt; &gt; 1.  You never know where your packets are going anyway 
&gt; -- You've never
&gt;  &gt; &gt;     known that at any time in the Internet's history.  
&gt; Get over it.
&gt;  &gt; &gt;     The only difference between a proxy and a 
&gt; multicast-supporting
&gt;  &gt; &gt;     router is that the router works at layer two and the 
&gt; proxy works
&gt;  &gt; &gt;     at layer 3.  Other that that they're doing basically 
&gt; the same job.
&gt;  &gt; 
&gt;  &gt; This statement is incorrect in at least two ways.  
&gt; Transparent proxying  &gt; has only become "the norm" over the 
&gt; last 5-6 years. 
&gt; 
&gt; So has high-speed internet access.  The two concepts are related.
&gt; 
&gt;  &gt; Prior to this, I
&gt;  &gt; would be justified in thinking that packets originating at 
&gt; my internet  &gt; connected machine, and addressed to another 
&gt; reachable machine on the  &gt; internet would reach that 
&gt; machine, regardless of which TCP port I tried  &gt; to connect to. 
&gt; 
&gt; Interesting - Which machine are you talking to when you send 
&gt; packets to 224.0.0.6 ?  And what path would you expect 

er... isn't 224.*.*.* broadcast or multicast or something? Isn't that
kind of irrelevant to the point here -- that when I do a TCP connect to
a host on port 80, I expect to connect to port 80 on that host, not on a
transparent proxy...

&gt; packets to take if you 
&gt; wanted to ping 63.18.243.12 ?  What about if you pinged 
&gt; 63.18.243.12 tomorrow instead of today - should the packets 
&gt; take the same path, or is it ok for them to take a completely 
&gt; different unknown path?

Again -- irrelevant. I don't care what _path_ the packets take, I care
where they get to in the end.

&gt; 
&gt; I repeat:  the principles behind caching are very similar to 
&gt; the principles behind multicast routing.  We just have a 
&gt; namespace of URLs instead of a namespace of IP addresses, and 

That's the thing though -- when I use a browser, I expect to be dealing
with a URL namespace, and don't generally care whether I connect through
a transparent proxy or not. However, when I use telnet, I expect to be
dealing with an IP namespace. This is not relevant for 99% of users, but
for people who want to diagnose network problems, it's an issue.

&gt; we have arbitrary files instead of packets. There's a reason 
&gt; why the large vendors are describing forward and reverse 
&gt; proxying as "content routing" in their technical and 
&gt; marketing literature these days.
&gt; 
&gt;  &gt; An example lifted almost directly from the slashdot 
&gt; article, and applied  &gt; to Internodes transparent proxying:
&gt;   [ ... ]
&gt;  &gt; Clearly this is not the same functionality as a 
&gt; multicasting-supporting  &gt; router, and neither is it 
&gt; operating at layer 3, as the "transparent"  &gt; proxy is 
&gt; clearly inspecting the application level data stream to  &gt; 
&gt; identify the host to which the connection should be made. 
&gt; 
&gt; A transparent proxy has effects which start at layer two and 
&gt; conceivably work their way all the way through the application layer.
&gt; 
&gt; Note that Akamai-style reverse proxies work through the 
&gt; presentation layer too; URLs for high-bandwidth content are 
&gt; rewritten so that they will be fetched from the nearest Akamai server.

The problem is that all this layer 3 and up stuff is visible when I am
using layer 2 only.

&gt; 
&gt;  &gt; &gt; 3.  Without transparent proxying, Broadband in Australia 
&gt; sucks.  &gt; 
&gt;  &gt; This is a reasonable argument, but again the underlying 
&gt; premise that the  &gt; only available type of proxy caching is 
&gt; transparent proxy caching is  &gt; wrong.  Sorry to be so blunt, 
&gt; but I don't know how else to say this.
&gt; 
&gt; The underlying premise is that any other kind of proxy 
&gt; caching is too difficult for a large-size non-technical 
&gt; userbase to understand, and that the caches on the market 
&gt; which do non-tranparent proxying are, to put it bluntly, crap.

This is true -- I can see the value of transparent proxying for 99% of
users -- in fact, 99% of the time, I appreciate it... What I want,
though, is a means of getting around it when I want to...

&gt; 
&gt; Both of those are insurmountable problems if you're 
&gt; attempting to use any of the non-transparent proxies which 
&gt; are available today.  Perhaps they'll be solved in a year or 
&gt; two, but unfortunately ISPs need to provide services today, 
&gt; not next year, so transparent proxying is what you get.

It would just be nice to be able to remove it from the path when doing
manual diagnosis etc...

&gt; 
&gt;  &gt; But these issues are not technical issues, they are 
&gt; business issues, and  &gt; although some benefits might accrue 
&gt; to the customers (through cost  &gt; savings passed on) there 
&gt; are really no technical benefits that I can see  &gt; that can 
&gt; not be achieved more flexibly in other ways.
&gt; 
&gt; They are technical benefits;  I'm sorry if you don't 
&gt; understand that. Be that as it may, the reason you've seen 
&gt; such a wide-scale deployment of transparent proxying in 
&gt; Australia over the last few years is because it simply isn't 
&gt; technically possible to deliver a high-quality high speed 
&gt; Internet service at the end of a 200 - 300 mSec RTT 
&gt; transpacific link without it.  I'm happy to be proved wrong, 
&gt; but the fact that I can't think of a single large-scale ISP 
&gt; which uses squid really should be 
&gt; speaking volumes to you.

Personally, I see (now) the technical benefit, as well as the business
benefit... The question is, is there a way around this magical benefit
stuff when it's not benefitting?

&gt; 
&gt;  &gt; &gt; A properly administered transparent proxy makes a world 
&gt; of difference  &gt; &gt; to performance with no impact at all on 
&gt; usability.  If you find a  &gt; &gt; usability impact, the only way 
&gt; anyone will know is if you complain  &gt; &gt; about it;  
&gt; coincidentally, complaining about it is sufficient to make  &gt; 
&gt; &gt; the problem go away in each and every case, because once 
&gt; the proxy  &gt; &gt; administrators know about it they can fix it 
&gt; very quickly.  &gt; 
&gt;  &gt; OK, I'll bite.  My usability problem is that each and 
&gt; every site that I  &gt; use nmap against from behind a 
&gt; transparent proxy shows up as having port  &gt; 80 open.  In 
&gt; some cases, I know for a fact that this is not true.  How  &gt; 
&gt; can I fix this?  (Tongue somewhat in cheek here)
&gt; 
&gt; You can fix this by doing exactly what I said above:  Ring us 
&gt; up and complain (or, more practically, visit 
&gt; <A HREF="http://support.on.net">http://support.on.net</A> and open a case).
&gt; 
&gt; If you have a burning desire to run nmap against a group of hosts, 
&gt; tell us what their IP addresses are and we'll add them to an 
&gt; ACL which turns off transparent proxying when you try to talk to them.

Well -- that would be the answer to my question... The thing is, it's
impossible for someone who doesn't work with the technology to know what
can be done with it. I suspected that this was possible, but didn't
think it practical. If the relevant ISP thinks it's practical, then I
guess I can live with that...

&gt; 
&gt; If you don't have a burning desire to run nmap against a 
&gt; group of hosts, but instead want to port-scan the entire 
&gt; Internet, then that'll be a 
&gt; different story, and we'll refer you to the bits in our terms 
&gt; and conditions which talk about being a good Internet citizen 
&gt; instead :-)
&gt; 
&gt; Either way, we're happy to work with you to achieve a good outcome, 
&gt; whatever that means.  Transparent proxies aren't supposed to 
&gt; stand in your way, they're supposed to make your life better. 
&gt;  If there's some wierd-arse reason specific to your 
&gt; circumstances which means that they aren't making your life 
&gt; better, let us know and we'll make them go away.
&gt; 
&gt; I don't know how we can be any more reasonable than that.  
&gt; The implicit expectation, though, is that you're going to try 
&gt; to be reasonable too.
&gt; 
&gt; When I say, "If there is a problem, ring us up and we'll make 
&gt; it go away," what I actually mean is, "If there is a problem, 
&gt; ring us up and we'll make it go away."  Sorry if I wasn't 
&gt; being clear enough :-)

Thanks -- the original question was not a jibe or anything towards
Internode, nor to any other ISP. I was mainly trying to ascertain
whether it's possible to avoid them through some trick... I don't know
exactly what... Maybe some TCP flag that nmap and telnet could set...


&gt; 
&gt; 
&gt; 
&gt; There's a serious undercurrent here, which I'll bring up in 
&gt; closing: It seems to me that there is a subset of Internet 
&gt; users who have 
&gt; convinced themselves that there is some reason why 
&gt; transparent proxying is worse than "opaque" proxying.  I'm 
&gt; interested to know why that is. Considering that you can turn 
&gt; squid from a non-transparent proxy into a transparent proxy 
&gt; by making some changes to your firewall configuration (i.e., 
&gt; the actual source code for a transparent proxy is provably 
&gt; equivalent to that for a non-transparent proxy), what do you 
&gt; see as the technical differences between them?

None, apart from the imperfect transparence...

&gt; 
&gt; Or do you have an objection to being made to use any kind of 
&gt; proxy at all?

Not at all -- I like proxies, I like faster internet, I like cheaper
internet, I like lower latency on international links.

rr


-- 
Richard Russell
Yellow Goanna Pty Ltd
e: <A HREF="mailto:richard@yellowgoanna.com">richard@yellowgoanna.com</A>
m: +61 412 827 805
f: +61 8 8462 2362
 

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
