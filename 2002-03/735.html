<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Transparent Proxying" -->
<!-- FromName="'Mark Newton'" -->
<!-- FromEmail="newton@atdot.dotat.org" -->
<!-- ToName="'Martin Sandiford'" -->
<!-- ToEmail="ms@mcdev.com.au" -->
<!-- Date="Tue, 26 Mar 2002 09:11:06 +1030" -->
<!-- Id="20020326091106.A38912@atdot.dotat.org" -->
<!-- Reference="m34rj4isse.fsf@plugh.mccorp.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Transparent Proxying</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Mark Newton &lt;<I><A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A></I>&gt;
  To  : Martin Sandiford &lt;<I><A HREF="mailto:ms@mcdev.com.au">ms@mcdev.com.au</A></I>&gt;
  Date: Tue, 26 Mar 2002 09:11:06 +1030
</PRE>
<H1>Re: Transparent Proxying</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Tue, Mar 26, 2002 at 01:44:09AM +1030, Martin Sandiford wrote:

 &gt; On Tue, 26 Mar 2002, <A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A> wrote:
 &gt; &gt; On Mon, Mar 25, 2002 at 09:13:47PM -0800, Richard Russell wrote:
 &gt; &gt; 
 &gt; &gt; 1.  You never know where your packets are going anyway -- You've never
 &gt; &gt;     known that at any time in the Internet's history.  Get over it.
 &gt; &gt;     The only difference between a proxy and a multicast-supporting
 &gt; &gt;     router is that the router works at layer two and the proxy works
 &gt; &gt;     at layer 3.  Other that that they're doing basically the same job.
 &gt; 
 &gt; This statement is incorrect in at least two ways.  Transparent proxying
 &gt; has only become "the norm" over the last 5-6 years. 

So has high-speed internet access.  The two concepts are related.

 &gt; Prior to this, I
 &gt; would be justified in thinking that packets originating at my internet
 &gt; connected machine, and addressed to another reachable machine on the
 &gt; internet would reach that machine, regardless of which TCP port I tried
 &gt; to connect to. 

Interesting - Which machine are you talking to when you send packets to
224.0.0.6 ?  And what path would you expect packets to take if you 
wanted to ping 63.18.243.12 ?  What about if you pinged 63.18.243.12
tomorrow instead of today - should the packets take the same path, or
is it ok for them to take a completely different unknown path?

I repeat:  the principles behind caching are very similar to the principles
behind multicast routing.  We just have a namespace of URLs instead of a
namespace of IP addresses, and we have arbitrary files instead of packets.
There's a reason why the large vendors are describing forward and reverse
proxying as "content routing" in their technical and marketing literature
these days.

 &gt; An example lifted almost directly from the slashdot article, and applied
 &gt; to Internodes transparent proxying:
  [ ... ]
 &gt; Clearly this is not the same functionality as a multicasting-supporting
 &gt; router, and neither is it operating at layer 3, as the "transparent"
 &gt; proxy is clearly inspecting the application level data stream to
 &gt; identify the host to which the connection should be made. 

A transparent proxy has effects which start at layer two and conceivably
work their way all the way through the application layer.

Note that Akamai-style reverse proxies work through the presentation
layer too; URLs for high-bandwidth content are rewritten so that they
will be fetched from the nearest Akamai server.

 &gt; &gt; 3.  Without transparent proxying, Broadband in Australia sucks.
 &gt; 
 &gt; This is a reasonable argument, but again the underlying premise that the
 &gt; only available type of proxy caching is transparent proxy caching is
 &gt; wrong.  Sorry to be so blunt, but I don't know how else to say this.

The underlying premise is that any other kind of proxy caching is too
difficult for a large-size non-technical userbase to understand, and
that the caches on the market which do non-tranparent proxying are, to
put it bluntly, crap.

Both of those are insurmountable problems if you're attempting to use
any of the non-transparent proxies which are available today.  Perhaps
they'll be solved in a year or two, but unfortunately ISPs need to provide
services today, not next year, so transparent proxying is what you get.

 &gt; But these issues are not technical issues, they are business issues, and
 &gt; although some benefits might accrue to the customers (through cost
 &gt; savings passed on) there are really no technical benefits that I can see
 &gt; that can not be achieved more flexibly in other ways.

They are technical benefits;  I'm sorry if you don't understand that.
Be that as it may, the reason you've seen such a wide-scale deployment
of transparent proxying in Australia over the last few years is because
it simply isn't technically possible to deliver a high-quality high
speed Internet service at the end of a 200 - 300 mSec RTT transpacific
link without it.  I'm happy to be proved wrong, but the fact that I can't
think of a single large-scale ISP which uses squid really should be 
speaking volumes to you.

 &gt; &gt; A properly administered transparent proxy makes a world of difference
 &gt; &gt; to performance with no impact at all on usability.  If you find a
 &gt; &gt; usability impact, the only way anyone will know is if you complain
 &gt; &gt; about it;  coincidentally, complaining about it is sufficient to make
 &gt; &gt; the problem go away in each and every case, because once the proxy
 &gt; &gt; administrators know about it they can fix it very quickly.
 &gt; 
 &gt; OK, I'll bite.  My usability problem is that each and every site that I
 &gt; use nmap against from behind a transparent proxy shows up as having port
 &gt; 80 open.  In some cases, I know for a fact that this is not true.  How
 &gt; can I fix this?  (Tongue somewhat in cheek here)

You can fix this by doing exactly what I said above:  Ring us up and
complain (or, more practically, visit <A HREF="http://support.on.net">http://support.on.net</A> and open
a case).

If you have a burning desire to run nmap against a group of hosts, 
tell us what their IP addresses are and we'll add them to an ACL which
turns off transparent proxying when you try to talk to them.

If you don't have a burning desire to run nmap against a group of hosts,
but instead want to port-scan the entire Internet, then that'll be a 
different story, and we'll refer you to the bits in our terms and conditions
which talk about being a good Internet citizen instead :-)

Either way, we're happy to work with you to achieve a good outcome, 
whatever that means.  Transparent proxies aren't supposed to stand in
your way, they're supposed to make your life better.  If there's some
wierd-arse reason specific to your circumstances which means that they
aren't making your life better, let us know and we'll make them go away.

I don't know how we can be any more reasonable than that.  The implicit
expectation, though, is that you're going to try to be reasonable too.

When I say, "If there is a problem, ring us up and we'll make it go
away," what I actually mean is, "If there is a problem, ring us up and
we'll make it go away."  Sorry if I wasn't being clear enough :-)



There's a serious undercurrent here, which I'll bring up in closing:
It seems to me that there is a subset of Internet users who have 
convinced themselves that there is some reason why transparent proxying
is worse than "opaque" proxying.  I'm interested to know why that is.
Considering that you can turn squid from a non-transparent proxy into
a transparent proxy by making some changes to your firewall configuration
(i.e., the actual source code for a transparent proxy is provably
equivalent to that for a non-transparent proxy), what do you see as
the technical differences between them?

Or do you have an objection to being made to use any kind of proxy at all?



    - mark

--------------------------------------------------------------------
I tried an internal modem,                    <A HREF="mailto:newton@atdot.dotat.org">newton@atdot.dotat.org</A>
     but it hurt when I walked.                          Mark Newton
----- Voice: +61-4-1620-2223 ------------- Fax: +61-8-82231777 -----

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
