<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Urgent web server problems." -->
<!-- FromName="'David Lloyd'" -->
<!-- FromEmail="davidl@tellurian.com.au" -->
<!-- ToName="'MWP'" -->
<!-- ToEmail="mwp@overclockers.com.au" -->
<!-- Date="Thu, 14 Mar 2002 09:37:10 +1030" -->
<!-- Id="3C8FDB9E.4F8FC6B9@tellurian.com.au" -->
<!-- Reference="Pine.LNX.4.33.0203140044340.22238-100000@overclockers.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Urgent web server problems.</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: David Lloyd &lt;<I><A HREF="mailto:davidl@tellurian.com.au">davidl@tellurian.com.au</A></I>&gt;
  To  : MWP &lt;<I><A HREF="mailto:mwp@overclockers.com.au">mwp@overclockers.com.au</A></I>&gt;
  Date: Thu, 14 Mar 2002 09:37:10 +1030
</PRE>
<H1>Re: Urgent web server problems.</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
MWP!

[note: At least my initials, DSL, actually are on topic ;-P]

&gt; We found that the bulk of the mysql database files had been corrupted, but
&gt; all other files on the two hdd's in the system appeared ok.

But how do you know? Personally I'd be performing a reinstall...

&gt; The databases where recreated using sql dump backups and the mysql db
&gt; permissions remade (where not backed up).

Ouch. Why do people insist on not doing back ups?

&gt; Once this had been done, the server was put back up, but the loadavg shot
&gt; up to &gt;100 with mysql using all the cpu time. This was with only a slight
&gt; web serving load.

Something else on the system that mysql uses may be corrupted but not to
the extent that it won't work; maybe it just goes slow or maybe it got
corrupted in such a way as to cause this behaviour. I think a reinstall
might fix this. Also, you should talk to the MySQL list
(<A HREF="http://www.mysql.com/">http://www.mysql.com/</A> and go search for it because I can't think of its
URL) -- it's very chatty but last time I looked it was also
extraorinarily helpful.

&gt; Mysql was using the same configs as it was before the crash... this
&gt; setup has worked fine for over 4 months.

Yes, but it's now obviously hit some type of glitch...

&gt; Is there anything else that i should look at which may be causing mysql to
&gt; use excessive amounts of cpu time?

If you lost a significant amount of data then I'd treat the whole system
as suspicious. To be perfectly honest, it may be easier and much more
reliable to reinstall the whole lot and see what happens -- you've
obviously fixed mysql (at least from what you've described) but
something else is broken. Given that it could be ANYTHING else, who
knows?

If you wanted, though, you could run mysql under strace (fiddle with the
startup scripts) but this would be fantastically chatty.

You could also try "nice"-ing the mysql process and see what happens.

I hope this helps, although it is difficult to diagnose problems with no
logs, no configuration files...

DSL

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
