<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: IP-MASQ Help!!!" -->
<!-- FromName="'Tim Fairchild'" -->
<!-- FromEmail="amosf@mrbean.net.au" -->
<!-- ToName="" -->
<!-- ToEmail="LinuxSA@linuxsa.org.au" -->
<!-- Date="Thu, 23 Nov 2000 01:51:16 +1000 (EST)" -->
<!-- Id="Pine.LNX.4.21.0011230132490.1311-100000@shiva.home" -->
<!-- Reference="007b01c0548f$da283ae0$0464a8c0@wulfz.com" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: IP-MASQ Help!!!</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Tim Fairchild &lt;<I><A HREF="mailto:amosf@mrbean.net.au">amosf@mrbean.net.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:LinuxSA@linuxsa.org.au">LinuxSA@linuxsa.org.au</A></I>&gt;
  Date: Thu, 23 Nov 2000 01:51:16 +1000 (EST)
</PRE>
<H1>Re: IP-MASQ Help!!!</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Thu, 23 Nov 2000, Darryl Ross wrote:

&gt; First off, you don't need to masquerade the Linux box (192.168.1.1), so you
&gt; can get rid of that. Also, it is normally better to masquerade an entire
&gt; network rather than set it up for each machine.
&gt; 
&gt; For a basic NAT setup, try the following commands (As you said, this has
&gt; absolutely ZERO security...):
&gt; 
&gt; /sbin/ipchains -F
&gt; /sbin/ipchains -P forward DENY
&gt; /sbin/ipchains -A forward -i eth0 -s 192.168.1.0/24 -s 0.0.0.0/0 -j MASQ
&gt; 
&gt; First line flushes all the rules out. Second line sets the default policy
&gt; for the forward chain to DENY and the third allows the internal hosts in the
&gt; network 192.168.1.0 to be masqueraded, as long as the data comes in from
&gt; eth0.
&gt; 
&gt; Use DENY instead of REJECT, because if someone tries to portscan you or
&gt; whatever, REJECT lets them know you are there and what they can and cannot
&gt; access, DENY just makes you appear like a black hole, so to speak. By the
&gt; way, the last rule in your forward chain is letting everyone in, despite
&gt; your default policy, so you might want to take it out :)

I realise most of this, but I was trying all sorts of things to get it to
work. I started with a line much like you have above, but no luck, so I
started putting all sorts of things in, like the last rule... I also
started with DENY, but I saw REJECT used in the how-to... 

Anyway, I did SOMETHING a little while ago and it started
working... Trouble is I don't have a clue what I did :-(  Since it's near
2am I think I'll call it a night and try and figure it out tomorrow.

I did run a script I found that had lines like

route add -net 192.168.1.0 netmask 255.255.255.0 eth0
route add default ppp0

I don't know if that was it or what... Or which one if either... 

Probably my fault with the ipchains rule... I used something like:

ipchains -A forward -s 192.168.1.0/24 -j MASQ

um I think I see where I went wrong there... I'll get into that again
tomorrow... the -i eth0 is probably important, right.
 
&gt; The routing tables and ifconfig output looks ok. And you said that samba and
&gt; the like is working, so your network is working ok.
&gt; 
&gt; Not bashing Windows or anything, but I believe the problem is on your
&gt; Windows box :)  Have you set the default gateway on the windows machine to
&gt; point to your gateway? I haven't used ME, so I can't tell you exactly where
&gt; to find the settings, but under 9x you go to Control Panel, Network, TCP/IP
&gt; (for your lan card) and add in the default gateway pointing to 192.168.1.1.

ME has been a real dog, but the net stuff was the same as 95... Well, it's
exactly like 95 really, just crashes a bit more and needs a lot more
resources...

Anyway, I'll look at more tomorrow and see if I can straighten it all
out. Then maybe close it up a little, tho it's only a temp connection
usually.

thanks very much

tim

-- 
---------------------------------------------------------
  Tim & Therese Fairchild
  Atchafalaya Border Collies.
  Kuttabul, Queensland, Australia.
---------------------------------------------------------
 Email       mailto:<A HREF="mailto:amosf@mrbean.net.au">amosf@mrbean.net.au</A>
 Homepage    <A HREF="http://www.home.aone.net.au/tims">http://www.home.aone.net.au/tims</A> 
 BCs4me Page <A HREF="http://members.xoom.com/amosf">http://members.xoom.com/amosf</A>
---------------------------------------------------------
 

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
