<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Linux 2.2 & Advanced routing" -->
<!-- FromName="'Mike O'Connor'" -->
<!-- FromEmail="mike@pineview.net" -->
<!-- ToName="'LinuxSA'" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Thu, 16 Nov 2000 14:13:46 +1030" -->
<!-- Id="002a01c04f7f$6c7c72f0$21ba26cb@themaster" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Linux 2.2 & Advanced routing</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Mike O &lt;<I><A HREF="mailto:mike@pineview.net">mike@pineview.net</A></I>&gt;
  To  : LinuxSA &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Thu, 16 Nov 2000 14:13:46 +1030
</PRE>
<H1>Linux 2.2 & Advanced routing</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Hi all

I'm trying to get a system with two links to the internet. One has class C
range routed into it and the other will need to be Masq'd.
I want to route traffic like smtp, http, https & ftp via the low cost link
(the Masq's one)

I've setup Advanced routing based on using 2.2 and ipchains & iproute2 using
Linux 2.4 Advanced Routing HOWTO as an example. (there is not a 2.2 how-to
for this even thought it is supposed to be able to do this type of thing) A
few of the command did not have a ipchains equivalent, particularly
'mangle'.

Using tcpdump I can see the packet come in from my notebook 203.33.246.2
which hits 203.33.246.1 and is MASQ'd to the Ipaddress of the isdn link. The
requested information is returned to the ISDN interface but nothing is seen
on the eth1 link going back to notebook.

I also watched the normal ppp link and there was no traffic on this link in
relation to the www connection.

The following is a list of the commands I used:

/sbin/ipchains -A forward -j MASQ -s 203.33.246.0/24 -i ippp+
/sbin/ipchains -A input -i eth1 -p tcp --dport 80 -m 1

<A HREF="mailto:root@ppro">root@ppro</A>:~# ip rule ls
0:      from all lookup local
32765:  from all fwmark        1 lookup mail.out
32766:  from all lookup main
32767:  from all lookup default
<A HREF="mailto:root@ppro">root@ppro</A>:~#

ip route add default dev ippp0 table mail.out

Any help would be great :)

Cheers & Thanks
    Mike O'Connor

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
