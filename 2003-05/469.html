<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: IP identifier field for linux UDP/IP equals zero??!" -->
<!-- FromName="'Alan Kennington'" -->
<!-- FromEmail="ak.linuxsa@topology.org" -->
<!-- ToName="'LinuxSA'" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Thu, 15 May 2003 09:03:25 +0930" -->
<!-- Id="20030515090325.A3775@dog.topology.org" -->
<!-- Reference="20030515084834.A46550@atdot.dotat.org" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: IP identifier field for linux UDP/IP equals zero??!</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Alan Kennington &lt;<I><A HREF="mailto:ak.linuxsa@topology.org">ak.linuxsa@topology.org</A></I>&gt;
  To  : LinuxSA &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Thu, 15 May 2003 09:03:25 +0930
</PRE>
<H1>Re: IP identifier field for linux UDP/IP equals zero??!</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Thu, May 15, 2003 at 08:48:35AM +0930, Mark Newton wrote:
&gt; 
&gt; The "Identification" (aka Fragment ID) field is only used for fragmentation.
&gt; Setting the DF bit turns off fragmentation, so the fragment ID isn't 
&gt; used.

Mark,

RFC 791, pages 8, doesn't seem to agree:

===========================================
The originating protocol module of
    an internet datagram sets the identification field to a value that
    must be unique for that source-destination pair and protocol for the
    time the datagram will be active in the internet system.
===========================================

Some humans have also informed me in the last hour that in fact
the linux implementation does contradict RFC 791.
There is no indication that I can find in RFC 791 that an exception
to the rule is made for packets with the DF bit set.

You're right about the stated purpose of the ID field.
However, when someone writes a spec and people implement that spec,
then other people who write other specs assuming that everyone will
implement the IP protocol according to the spec, it's very inconvenient
when someone chooses to break the spec for all machine using
a particular operating system, in this case linux.
That's what's happened in this case. It's an embarrassment that
linux has acted on the assumption that the RFC can be improved upon,
in the just the same way that MS-Windows "improves" TCP 3-way handshakes
to 1-way handshakes.
In the linux case, this makes another IETF protocol work at 50% efficiency
because of the zero ID fields.

&gt; While I'm sure it'd be convenient for your application if the standard
&gt; required more from the Identification field, it actually doesn't.  It's
&gt; possible that some TCP/IP stacks set it on every IP packet, but they're
&gt; going above and beyond the requirements of the TCP/IP spec in doing so.

Nope. It isn't "convenient" for my application. It's assumed by
another, more recent RFC.

&gt;  &gt; Does anyone out there happen to know if there is some official
&gt;  &gt; excuse for why linux doesn't seem to do quite the right thing here?
&gt; 
&gt; You're making assumptions again :-)

Everybody makes assumptions. Some assumptions are correct, and some are not.
You can't function without assumptions in a complex world.
And notice that little word "seems". That's not an assumption, is it.

&gt; Incidentally, you're probably seeing lots of packets with the DF bit set
&gt; because the IP stack is attempting to use Path MTU discovery (RFC 1191,
&gt; <A HREF="ftp://ftp.rfc-editor.org/in-notes/rfc1191.txt">ftp://ftp.rfc-editor.org/in-notes/rfc1191.txt</A> )

Nope. It's because I'm running "ohphone" to generate voice RTP packets,
which all use DF.
They're coming out every 80 mSec, although I can set it to 20 mSec.
This is less than the 
"time the datagram will be active in the internet system"
for even my 19200 bits/sec null modem in the lab.

Cheers,
Alan Kennington.

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
