<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Network monitoring: nPulse" -->
<!-- FromName="'Nick Morrison'" -->
<!-- FromEmail="nickm@bhwb.nsw.gov.au" -->
<!-- ToName="" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Tue, 13 Feb 2001 16:54:33 +1030" -->
<!-- Id="20010213165433.B22198@medusa.aiew" -->
<!-- Reference="3A88D2BC.87FBAB96@rebel.net.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Network monitoring: nPulse</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Nick Morrison &lt;<I><A HREF="mailto:nickm@bhwb.nsw.gov.au">nickm@bhwb.nsw.gov.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Tue, 13 Feb 2001 16:54:33 +1030
</PRE>
<H1>Re: Network monitoring: nPulse</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
It was Tue, Feb 13, 2001 at 04:52:52PM +1030.  David Lloyd spake:
&gt; 
&gt; Nick et al:
&gt; 
&gt; On the other hand, I with a co-worker concluded that:
&gt; 
&gt; 1) nPulse took a system down through accidental means
&gt; 2) nPulse may contain a trojan
&gt; 
&gt; Essentially it killed tcpd and somehow caused name resolution to fail.
&gt; If it hadn't caused name resolution to fail I would be less suspicious
&gt; of it. Here is a likely sequence of events:
&gt; 
&gt; 1) install nPulse
&gt; 
&gt; - on Saturday morning
&gt; 
&gt; 2) nPulse
&gt; 
&gt; - begine running nmap (as its backend)
&gt; 
&gt; 3) nPulse
&gt; 
&gt; - starts to behave suspiciously
&gt; - starts scanning ports and attempting to make connections to in.ftpd
&gt; and in.telnetd and pop3 and ssh

... that's what nmap does to see if the ports are open.  It's normal nmap
behaviour.  In fact, that's what nPulse is designed to do.

&gt; 4) Unknown error
&gt; 
&gt; - somehwere DNS goes and it falls back to /etc/hosts
&gt; - ssh baulks because it resolves hostname.the.company to the wrong (but
&gt; legitimate) IP address
&gt; - in addition see (5) for identd

If you watch carefully what nPulse does, you'll see that it fires off a lot
of nmaps if you allow it to.  These are bandwidth-hungry, so you *must* be
careful - especially considering it's beta software.

&gt; 5) TCPD
&gt; 
&gt; - somewhere TCPD notices the port scan failures
&gt; - TCPD thinks there's a possible breakin and starts denying connections,
&gt; including ident which ssh and sendmail uses

Fair enough...

&gt; 6) Result
&gt; 
&gt; - no system logins allowed via ftp, telnet, pop or ssh
&gt; - name service fails on the machine
&gt; - it looks like a broken into system
&gt; 
&gt; I intend to take a very, very careful look at the nPulse source and have
&gt; a go at seeing whether it's trojan. In addition, nmap itself (well, it
&gt; is a port scanner and I can think of more illegitimate uses for it than
&gt; legitimate ones) has always been subject to my mind.

Davo,

Interesting thoughts.  I'll have a bit of a close watch.

Let's hope it's not a trojan.  :)

-- 

Nick Morrison &lt;<A HREF="mailto:nickm@bhwb.nsw.gov.au">nickm@bhwb.nsw.gov.au</A>&gt;

Australian Inland Energy and Water
<A HREF="http://www.aienergy.com.au/">http://www.aienergy.com.au/</A>

Phone:  +61 8 8082 5405
Fax:    +61 8 8080 2430

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
