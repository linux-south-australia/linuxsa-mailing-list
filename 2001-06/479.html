<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE: PHP question" -->
<!-- FromName="'Charlie M MAO'" -->
<!-- FromEmail="cmm@rla.com.au" -->
<!-- ToName="'James Mclean'" -->
<!-- ToEmail="james@adam.com.au" -->
<!-- Date="Wed, 13 Jun 2001 16:29:15 +0930" -->
<!-- Id="NEBBKANNOKNIICLMGNHLAEBICIAA.cmm@rla.com.au" -->
<!-- Reference="992412481.3b2703411837d@thunder.adam.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE: PHP question</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Charlie M MAO &lt;<I><A HREF="mailto:cmm@rla.com.au">cmm@rla.com.au</A></I>&gt;
  To  : James Mclean &lt;<I><A HREF="mailto:james@adam.com.au">james@adam.com.au</A></I>&gt;
  Date: Wed, 13 Jun 2001 16:29:15 +0930
</PRE>
<H1>RE: PHP question</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Please insert the following statement

echo mysql_affected_rows()."mysql_affected_rows&lt;br&gt;";

between
$aqu = mysql_query($asql) or die(mysql_error());

if(mysql_affected_rows()=='0') {

you will find if there is no record -1 is returned.

Read these
int mysql_affected_rows(int [link_identifier] );
mysql_affected_rows returns the number of rows affected by the last INSERT,
UPDATE or DELETE query on the server associated with the specified link
identifier. If the link identifier isn't specified, the last opened link is
assumed.
If the last query was a DELETE query with no WHERE clause, all of the
records will have been deleted from the table but this function will return
zero.
This command is not effective for SELECT statements, only on statements
which modify records. To retrieve the number of rows returned from a SELECT,
use mysql_num_rows.

Cheers


Charlie

-----Original Message-----
From: James Mclean [mailto:<A HREF="mailto:james@adam.com.au">james@adam.com.au</A>]
Sent: Wednesday, 13 June 2001 3:38 PM
To: <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>
Subject: PHP question


All,
I have a piece of code below, not working as it should. What should happen
is
the function is called, then needs to return a result. The SELECT's and
INSERTS
function as expected, however when the INSERT is called and executes OK, it
does not appear to return the value with mysql_insert_id().
I read php.net/mysql_insert_id and the DB is set up correctly according to
thier directions. (IE not BIGINT and is AUTO_INCREMENT)

Included is the code in question...

&lt;?
function findart($art,$artn) {
    $asql = "SELECT artist FROM artists WHERE artist='$art'";
    $aqu = mysql_query($asql) or die(mysql_error());

    if(mysql_affected_rows()=='0') {
        $isql = "INSERT INTO artists (artist) VALUES ('$art')";
        $iqu = mysql_query($isql) or die(mysql_error());
        return mysql_insert_id();
    } else {
        return $artn;
    }
}



    $artist = findart($artw,$artn); //call the function.

    //extra code here
?&gt;


Now if i call $artist in the rest of the code, it will return the value of
the
function, right? Wrong?

Also, the auto_increment field is artID, and the artist field is varchar


Thanks

James Mclean

--
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
