<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: cant enable dma on pioneer dvd drive?" -->
<!-- FromName="'Anthony Symons'" -->
<!-- FromEmail="ant@sa.pracom.com.au" -->
<!-- ToName="'Anthony Symons'" -->
<!-- ToEmail="ant@sa.pracom.com.au" -->
<!-- Date="28 Nov 2002 08:55:57 +1030" -->
<!-- Id="1038435957.13252.17.camel@ant.internal" -->
<!-- Reference="1038435338.13248.13.camel@ant.internal" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: cant enable dma on pioneer dvd drive?</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Anthony Symons &lt;<I><A HREF="mailto:ant@sa.pracom.com.au">ant@sa.pracom.com.au</A></I>&gt;
  To  : Anthony Symons &lt;<I><A HREF="mailto:ant@sa.pracom.com.au">ant@sa.pracom.com.au</A></I>&gt;
  Date: 28 Nov 2002 08:55:57 +1030
</PRE>
<H1>Re: cant enable dma on pioneer dvd drive?</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Heres the relevant section of the strace output from hdparm:

write(1, " setting using_dma to 1 (on)\n", 29 setting using_dma to 1
(on)
) = 29
ioctl(3, 0x326, 0x1)                    = -1 EPERM (Operation not
permitted)
dup(2)                                  = 4
fcntl64(4, F_GETFL)                     = 0x8002 (flags
O_RDWR|O_LARGEFILE)
brk(0)                                  = 0x80538e4
brk(0x80548e4)                          = 0x80548e4
brk(0x8055000)                          = 0x8055000
fstat64(4, {st_mode=S_IFCHR|0620, st_rdev=makedev(136, 3), ...}) = 0
mmap2(NULL, 4096, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, -1,
0) = 0x40014000
_llseek(4, 0, 0xbfffeda0, SEEK_CUR)     = -1 ESPIPE (Illegal seek)
write(4, " HDIO_SET_DMA failed: Operation "..., 46 HDIO_SET_DMA failed:
Operation not permitted
) = 46

I am root....

What now?

PS excuse the really bad english in the prior email. Time to go and get
the first coffee for the day.....

Ant


On Thu, 2002-11-28 at 08:45, Anthony Symons wrote:
&gt; This is a strange one. My Pioneer DVD used to run with DMA no troubled.
&gt; I noticed however that now it wont. It lost the ability some time
&gt; recently. It could have been when I replaced the motherboard, or when I
&gt; installed redhat 8.0.
&gt; 
&gt; The bios claims it can do dma, linux says the bios said it can do dma,
&gt; but when I get a shell, dma is disabled, and I cant turn it back on. The
&gt; other 3 ide devices (HDDs) in the system are running DMA no worries.
&gt; Could it be because I have an ata 100 HDD on the same chain as the DVD
&gt; which is ATA 33? Im sure It used to work with my last configuration on 
&gt; my old motherboard with a 33 and a 66mhz sharing a chain, and it worked
&gt; OK though.
&gt; 
&gt; See below for kernel output.
&gt; 
&gt; Any ideas on the cause? Or anything to try? DVD is on HDB.
&gt; 
&gt; kernel messages:
&gt; 
&gt; Linux version 2.4.18-14 (<A HREF="mailto:bhcompile@stripples.devel.redhat.com">bhcompile@stripples.devel.redhat.com</A>) (gcc
&gt; version 3.2 20020903 (Red Hat Linux 8.0 3.2-7)) #1 Wed Sep 4 13:35:50
&gt; EDT 2002
&gt; BIOS-provided physical RAM map:
&gt;  BIOS-e820: 0000000000000000 - 000000000009fc00 (usable)
&gt;  BIOS-e820: 000000000009fc00 - 00000000000a0000 (reserved)
&gt;  BIOS-e820: 00000000000f0000 - 0000000000100000 (reserved)
&gt;  BIOS-e820: 0000000000100000 - 0000000017ff0000 (usable)
&gt;  BIOS-e820: 0000000017ff0000 - 0000000017ff8000 (ACPI data)
&gt;  BIOS-e820: 0000000017ff8000 - 0000000018000000 (ACPI NVS)
&gt;  BIOS-e820: 00000000fec00000 - 00000000fec01000 (reserved)
&gt;  BIOS-e820: 00000000fee00000 - 00000000fee01000 (reserved)
&gt;  BIOS-e820: 00000000fff80000 - 0000000100000000 (reserved)
&gt; 0MB HIGHMEM available.
&gt; 383MB LOWMEM available.
&gt; On node 0 totalpages: 98288
&gt; zone(0): 4096 pages.
&gt; zone(1): 94192 pages.
&gt; zone(2): 0 pages.
&gt; Kernel command line: ro root=LABEL=/1
&gt; Initializing CPU#0
&gt; Detected 1108.065 MHz processor.
&gt; Speakup v-1.00 CVS: Tue Jun 11 14:22:53 EDT 2002 : initialized
&gt; Console: colour VGA+ 80x25
&gt; Calibrating delay loop... 2199.78 BogoMIPS
&gt; Memory: 382028k/393152k available (1326k kernel code, 8560k reserved,
&gt; 999k data, 212k init, 0k highmem)
&gt; Dentry cache hash table entries: 65536 (order: 7, 524288 bytes)
&gt; Inode cache hash table entries: 32768 (order: 6, 262144 bytes)
&gt; Mount cache hash table entries: 8192 (order: 4, 65536 bytes)
&gt; ramfs: mounted with options: &lt;defaults&gt;
&gt; ramfs: max_pages=48025 max_file_pages=0 max_inodes=0 max_dentries=48025
&gt; Buffer cache hash table entries: 32768 (order: 5, 131072 bytes)
&gt; Page-cache hash table entries: 131072 (order: 7, 524288 bytes)
&gt; CPU: Before vendor init, caps: 0383fbff 00000000 00000000, vendor = 0
&gt; CPU: L1 I cache: 16K, L1 D cache: 16K
&gt; CPU: L2 cache: 256K
&gt; CPU: After vendor init, caps: 0383fbff 00000000 00000000 00000000
&gt; Intel machine check architecture supported.
&gt; Intel machine check reporting enabled on CPU#0.
&gt; CPU:     After generic, caps: 0383fbff 00000000 00000000 00000000
&gt; CPU:             Common caps: 0383fbff 00000000 00000000 00000000
&gt; CPU: Intel(R) Celeron(TM) CPU                1100MHz stepping 01
&gt; Enabling fast FPU save and restore... done.
&gt; Enabling unmasked SIMD FPU exception support... done.
&gt; Checking 'hlt' instruction... OK.
&gt; POSIX conformance testing by UNIFIX
&gt; mtrr: v1.40 (20010327) Richard Gooch (<A HREF="mailto:rgooch@atnf.csiro.au">rgooch@atnf.csiro.au</A>)
&gt; mtrr: detected mtrr type: Intel
&gt; PCI: PCI BIOS revision 2.10 entry at 0xfdb51, last bus=1
&gt; PCI: Using configuration type 1
&gt; PCI: Probing PCI hardware
&gt; Unknown bridge resource 0: assuming transparent
&gt; PCI: Using IRQ router VIA [1106/0686] at 00:07.0
&gt; isapnp: Scanning for PnP cards...
&gt; isapnp: No Plug & Play device found
&gt; speakup:  initialized device: /dev/synth, node (MAJOR 10, MINOR 25)
&gt; Linux NET4.0 for Linux 2.4
&gt; Based upon Swansea University Computer Society NET3.039
&gt; Initializing RT netlink socket
&gt; apm: BIOS version 1.2 Flags 0x03 (Driver version 1.16)
&gt; Starting kswapd
&gt; VFS: Diskquotas version dquot_6.5.0 initialized
&gt; pty: 2048 Unix98 ptys configured
&gt; Serial driver version 5.05c (2001-07-08) with MANY_PORTS MULTIPORT
&gt; SHARE_IRQ SERIAL_PCI ISAPNP enabled
&gt; ttyS0 at 0x03f8 (irq = 4) is a 16550A
&gt; ttyS1 at 0x02f8 (irq = 3) is a 16550A
&gt; Real Time Clock Driver v1.10e
&gt; opro<A HREF="file:">file:</A> mapping APIC.
&gt; opro<A HREF="file:">file:</A> APIC was already enabled
&gt; oprofile 0.2 loaded, major 254
&gt; block: 736 slots per queue, batch=184
&gt; Uniform Multi-Platform E-IDE driver Revision: 6.31
&gt; ide: Assuming 33MHz system bus speed for PIO modes; override with
&gt; idebus=xx
&gt; VP_IDE: IDE controller on PCI bus 00 dev 39
&gt; VP_IDE: chipset revision 6
&gt; VP_IDE: not 100% native mode: will probe irqs later
&gt; ide: Assuming 33MHz system bus speed for PIO modes; override with
&gt; idebus=xx
&gt; VP_IDE: VIA vt82c686b (rev 40) IDE UDMA100 controller on pci00:07.1
&gt;     ide0: BM-DMA at 0xff00-0xff07, BIOS settings: hda:DMA, hdb:DMA
&gt;     ide1: BM-DMA at 0xff08-0xff0f, BIOS settings: hdc:DMA, hdd:DMA
&gt; hda: WDC WD1000BB-00CAA1, ATA DISK drive
&gt; hdb: Pioneer DVD-ROM ATAPIModel DVD-115 0127, ATAPI CD/DVD-ROM drive
&gt; hdc: ST317242A, ATA DISK drive
&gt; hdd: ST330630A, ATA DISK drive
&gt; ide0 at 0x1f0-0x1f7,0x3f6 on irq 14
&gt; ide1 at 0x170-0x177,0x376 on irq 15
&gt; hda: 195371568 sectors (100030 MB) w/2048KiB Cache, CHS=12161/255/63,
&gt; UDMA(100)
&gt; hdc: 33683328 sectors (17246 MB) w/512KiB Cache, CHS=33416/16/63,
&gt; UDMA(33)
&gt; hdd: 59777640 sectors (30606 MB) w/2048KiB Cache, CHS=59303/16/63,
&gt; UDMA(66)
&gt; ide-floppy driver 0.99.newide
&gt; Partition check:
&gt;  hda: hda1 hda2 hda3 hda4 &lt; hda5 &gt;
&gt;  hdc: [PTBL] [2096/255/63] hdc1
&gt;  hdd: hdd1 hdd2 hdd4
&gt; Floppy drive(s): fd0 is 1.44M
&gt; FDC 0 is a post-1991 82077
&gt; NET4: Frame Diverter 0.46
&gt; RAMDISK driver initialized: 16 RAM disks of 4096K size 1024 blocksize
&gt; ide-floppy driver 0.99.newide
&gt; md: md driver 0.90.0 MAX_MD_DEVS=256, MD_SB_DISKS=27
&gt; md: Autodetecting RAID arrays.
&gt; md: autorun ...
&gt; md: ... autorun DONE.
&gt; NET4: Linux TCP/IP 1.0 for NET4.0
&gt; IP Protocols: ICMP, UDP, TCP, IGMP
&gt; IP: routing cache hash table of 4096 buckets, 32Kbytes
&gt; TCP: Hash tables configured (established 32768 bind 65536)
&gt; Linux IP multicast router 0.06 plus PIM-SM
&gt; NET4: Unix domain sockets 1.0/SMP for Linux NET4.0.
&gt; RAMDISK: Compressed image found at block 0
&gt; Freeing initrd memory: 237k freed
&gt; VFS: Mounted root (ext2 filesystem).
&gt; SCSI subsystem driver Revision: 1.00
&gt; kmod: failed to exec /sbin/modprobe -s -k scsi_hostadapter, errno = 2
&gt; PCI: Found IRQ 11 for device 00:0e.0
&gt; scsi0 : AdvanSys SCSI 3.3G: PCI Ultra: IO 0xDC00-0xDC0F, IRQ 0xB
&gt;   Vendor: MATSHITA  Model: CD-ROM CR-508     Rev: XS03
&gt;   Type:   CD-ROM                             ANSI SCSI revision: 02
&gt;   Vendor: MATSHITA  Model: CD-R   CW-7503    Rev: 1.09
&gt;   Type:   CD-ROM                             ANSI SCSI revision: 02
&gt; Journalled Block Device driver loaded
&gt; kjournald starting.  Commit interval 5 seconds
&gt; EXT3-fs: mounted filesystem with ordered data mode.
&gt; Freeing unused kernel memory: 212k freed
&gt; usb.c: registered new driver usbdevfs
&gt; usb.c: registered new driver hub
&gt; usb-uhci.c: $Revision: 1.275 $ time 13:44:31 Sep  4 2002
&gt; usb-uhci.c: High bandwidth mode enabled
&gt; PCI: Found IRQ 5 for device 00:07.2
&gt; usb-uhci.c: USB UHCI at I/O 0xcc00, IRQ 5
&gt; usb-uhci.c: Detected 2 ports
&gt; usb.c: new USB bus registered, assigned bus number 1
&gt; hub.c: USB hub found
&gt; hub.c: 2 ports detected
&gt; usb-uhci.c: v1.275:USB Universal Host Controller Interface driver
&gt; usb.c: registered new driver hiddev
&gt; usb.c: registered new driver hid
&gt; hid-core.c: v1.8.1 Andreas Gal, Vojtech Pavlik &lt;<A HREF="mailto:vojtech@suse.cz">vojtech@suse.cz</A>&gt;
&gt; hid-core.c: USB HID support drivers
&gt; mice: PS/2 mouse device common for all mice
&gt; EXT3 FS 2.4-0.9.18, 14 May 2002 on ide0(3,5), internal journal
&gt; Adding Swap: 522104k swap-space (priority -1)
&gt; kjournald starting.  Commit interval 5 seconds
&gt; EXT3 FS 2.4-0.9.18, 14 May 2002 on ide0(3,2), internal journal
&gt; EXT3-fs: mounted filesystem with ordered data mode.
&gt; parport0: PC-style at 0x378 [PCSPP,TRISTATE,EPP]
&gt; parport_pc: Via 686A parallel port: io=0x378
&gt; ohci1394: pci_module_init failed
&gt; ip_tables: (C) 2000-2002 Netfilter core team
&gt; 8139too Fast Ethernet driver 0.9.25
&gt; PCI: Found IRQ 10 for device 00:10.0
&gt; PCI: Sharing IRQ 10 with 00:07.5
&gt; divert: allocating divert_blk for eth0
&gt; eth0: RealTek RTL8139 Fast Ethernet at 0xd88bae00, 00:00:21:d5:aa:29,
&gt; IRQ 10
&gt; eth0:  Identified 8139 chip type 'RTL-8139A'
&gt; eth0: Setting 100mbps full-duplex based on auto-negotiated partner
&gt; ability 45e1.
&gt; nvidia: loading NVIDIA Linux x86 NVdriver Kernel Module  1.0-3123  Tue
&gt; Aug 27 15:56:48 PDT 2002
&gt; Linux agpgart interface v0.99 (c) Jeff Hartmann
&gt; agpgart: Maximum main memory to use for agp memory: 321M
&gt; agpgart: Detected Via Apollo Pro chipset
&gt; agpgart: AGP aperture is 64M @ 0xe0000000
&gt; NVRM: AGPGART: VIA Apollo Pro chipset
&gt; NVRM: AGPGART: aperture: 64M @ 0xe0000000
&gt; NVRM: AGPGART: aperture mapped from 0xe0000000 to 0xd9ad5000
&gt; NVRM: AGPGART: mode 4x
&gt; NVRM: AGPGART: allocated 16 pages
&gt; Via 686a audio driver 1.9.1
&gt; PCI: Found IRQ 10 for device 00:07.5
&gt; PCI: Sharing IRQ 10 with 00:10.0
&gt; ac97_codec: AC97 Audio codec, id: 0x5649:0x4161 (Unknown)
&gt; via82cxxx: board #1 at 0xD800, IRQ 10
&gt; Assertion failed! buffer !=
&gt; NULL,via82cxxx_audio.c,via_dsp_write,line=2308
&gt; ide-floppy driver 0.99.newide
&gt; hdb: ATAPI 40X DVD-ROM drive, 512kB Cache
&gt; Uniform CD-ROM driver Revision: 3.12
&gt; Attached scsi CD-ROM sr0 at scsi0, channel 0, id 0, lun 0
&gt; Attached scsi CD-ROM sr1 at scsi0, channel 0, id 1, lun 0
&gt; sr0: scsi-1 drive
&gt; sr1: scsi3-mmc drive: 8x/20x writer cd/rw xa/form2 cdda tray
&gt; cdrom: This disc doesn't have any tracks I recognize!
&gt; NVRM: AGPGART: allocated 258 pages
&gt; NVRM: AGPGART: freed 258 pages
&gt; NVRM: AGPGART: allocated 258 pages
&gt; NVRM: AGPGART: allocated 256 pages
&gt; NVRM: AGPGART: allocated 2304 pages
&gt; NVRM: AGPGART: freed 2304 pages
&gt; NVRM: AGPGART: freed 256 pages
&gt; NVRM: AGPGART: freed 258 pages
&gt; 
&gt; hdparm /dev/hdb:
&gt; 
&gt;  HDIO_GET_MULTCOUNT failed: Invalid argument
&gt;  HDIO_GETGEO failed: Invalid argument
&gt; 
&gt; /dev/hdb:
&gt;  IO_support   =  1 (32-bit)
&gt;  unmaskirq    =  1 (on)
&gt;  using_dma    =  0 (off)
&gt;  keepsettings =  0 (off)
&gt;  readonly     =  1 (on)
&gt;  readahead    =  8 (on)
&gt; 
&gt; hdparm -d 1 /dev/hdb:
&gt; 
&gt;  HDIO_SET_DMA failed: Operation not permitted
&gt; 
&gt; /dev/hdb:
&gt;  setting using_dma to 1 (on)
&gt;  using_dma    =  0 (off)
&gt; -- 
&gt; Systems Administrator       
&gt; Pracom Ltd.             
&gt; +61 8 82029074 -=- +61 402 100 671 
&gt; <A HREF="mailto:anthony.symons@sa.pracom.com.au">anthony.symons@sa.pracom.com.au</A>
&gt; 
&gt; PRIVILEGED - PRIVATE AND CONFIDENTIAL
&gt; This electronic mail is solely for the use of the addressee and may
&gt; contain information which is confidential or privileged.
&gt; If you receive this electronic mail in error, please delete it from
&gt; your system immediately and notify the sender by electronic mail or
&gt; using any of the above contact details.
&gt; 
&gt; -- 
&gt; LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.openprojects.net
&gt; To unsubscribe from the LinuxSA list:
&gt;   mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject
&gt; 
-- 
Systems Administrator       
Pracom Ltd.             
+61 8 82029074 -=- +61 402 100 671 
<A HREF="mailto:anthony.symons@sa.pracom.com.au">anthony.symons@sa.pracom.com.au</A>

PRIVILEGED - PRIVATE AND CONFIDENTIAL
This electronic mail is solely for the use of the addressee and may
contain information which is confidential or privileged.
If you receive this electronic mail in error, please delete it from
your system immediately and notify the sender by electronic mail or
using any of the above contact details.

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.openprojects.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
