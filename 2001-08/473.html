<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Blocking Code Red ingress to your ISP network" -->
<!-- FromName="'Simon Hackett'" -->
<!-- FromEmail="simon@internode.com.au" -->
<!-- ToName="'David Newall'" -->
<!-- ToEmail="davidn@rebel.net.au" -->
<!-- Date="Sun, 12 Aug 2001 14:08:17 +0930" -->
<!-- Id="p05100304b79bb7047414@[150.101.234.83]" -->
<!-- Reference="Pine.LNX.4.21.0108121115270.11566-100000@smart-panel.tellurian.com.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Blocking Code Red ingress to your ISP network</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Simon Hackett &lt;<I><A HREF="mailto:simon@internode.com.au">simon@internode.com.au</A></I>&gt;
  To  : David Newall &lt;<I><A HREF="mailto:davidn@rebel.net.au">davidn@rebel.net.au</A></I>&gt;
  Date: Sun, 12 Aug 2001 14:08:17 +0930
</PRE>
<H1>Re: Blocking Code Red ingress to your ISP network</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
My apologies.

I've dropped that block again for the time being.

We have multiple blocks 'up' in our network already, have had for some time.

The one you just ran into is a block in our cache engines, which 
notices outbound attempts to hit on /default.ida and blocks them. The 
reason this has been there has been

(a) to avoid our cache being overwhelmed with a connection table full 
of invalid addresses (remembering it gets the load from our entire 
customer base) and

(b) to try to stop our customers, those who get broken into by the 
worm, from attacking outward to the rest of the world.

This is 100% unrelated to the NBAR blocking we've more recently 
applied inward on our network. The two are working in different 
directions.

Now, the trouble with the cache engine blocking rules is that it's 
not that I didn't think of matching on a very good approximation of 
the signature of the worm, based on factors including length. Its 
that the current code base in the Cache Engines strips all CGI 
arguments before giving me a shot at matching a url. So all the 'long 
bits' are unavailable to match against (argh).

I have been in conversation with the authors of the relevant software 
(as we're a Cache Engine beta site - which has its privileges) and 
they get my point on this and they're looking at it.

I've just isolated that site from cacheing so that it's accessible again now.

If it becomes more of a nuisance than that, then we'll see what else 
we can do. This is a classic case of needing to do the best we can 
for the majority, with the tools that we have at our disposal.

Again, this block predates the NBAR blocking inbound on our core 
router (and for various reasons, that blocking is much harder to 
implement in the other direction - not impossible, but harder, and to 
date not required).

As soon as the dust has settled a bit more we expect to be able to 
drop the blocking rules completely (or, hopefully, find a better 
matching mechanism via software hacks to the Cache Engies so we can 
avoid the odd edge case of false-positive matches like this).

Cheers,
   Simon

At 11:22 AM +0930 12/8/01, David Newall wrote:
&gt;  &gt; The following link is tempting:
&gt;&gt;  <A HREF="http://www.dasbistro.com/default.ida">http://www.dasbistro.com/default.ida</A>
&gt;
&gt;Now that's annoying.  I get "Error 400 Request blocked due to Rules
&gt;Template Configuration."  I suppose I'm never again going to be able to
&gt;access any web page called default.ida, at least through my current ISP,
&gt;even though there might be a completely valid web page named thus.  What
&gt;will happen when somebody releases Code Red III (uses the URL index.html)?
&gt;Suddenly the complete Web stops working?
&gt;
&gt;Blocking on the URL is obviously well intended, and by all reports has
&gt;had early success, but it's wrong, and it probably won't take long for
&gt;the virus to be "fixed."  Why not match on that very long string of X's?
&gt;That's a much more accurate signature.


-- 

---
Simon Hackett, Technical Director, Internode Systems Pty Ltd
31 York St [PO Box 284, Rundle Mall], Adelaide, SA 5000 Australia
Email: <A HREF="mailto:simon@internode.com.au">simon@internode.com.au</A>  Web: <A HREF="http://www.on.net">http://www.on.net</A>
Phone: +61-8-8223-2999          Fax: +61-8-8223-1777

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
