<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: [OT] Virus Signatures" -->
<!-- FromName="'Richard Sharpe'" -->
<!-- FromEmail="sharpe@ns.aus.com" -->
<!-- ToName="'Jim O'Halloran'" -->
<!-- ToEmail="jim@kendle.com.au" -->
<!-- Date="Fri, 10 Aug 2001 15:33:36 +0930" -->
<!-- Id="3B737938.4010309@ns.aus.com" -->
<!-- Reference="C16C7A51BA30D51187EE0000E8D8C99707850D@KCSSERVER" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: [OT] Virus Signatures</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Richard Sharpe &lt;<I><A HREF="mailto:sharpe@ns.aus.com">sharpe@ns.aus.com</A></I>&gt;
  To  : Jim O &lt;<I><A HREF="mailto:jim@kendle.com.au">jim@kendle.com.au</A></I>&gt;
  Date: Fri, 10 Aug 2001 15:33:36 +0930
</PRE>
<H1>Re: [OT] Virus Signatures</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Jim O'Halloran wrote:
&gt; I had a quick read of one of the disassemblies of the Code Red 2 worm, 
&gt; and it seems that the AAAA  or whatever is significant, in that you 
&gt; need a lot of data to overflow a  buffer (i.e.. lots of X's or N's) 
&gt; used for an ASCII to Unicode (double byte character) conversion.  Two 
&gt; of the characters from the converted buffer then get used to form the 
&gt; jump address into the actual worm code.  In the case of CodeRed2, that 
&gt; code ends up at an address something like 0x004E004E (which when 
&gt; written in ASCII is NN).
&gt;
&gt; I'm no expert in assembler, or buffer overflows by any means, but 
&gt; that's how I read the analysis.  So its not really a case of the Black 
&gt; Hat's signing their work, as a case of being the easiest way to 
&gt; achieve the desired effect when overflowing the buffer.

There is a technique of finding buffer overflows by sending long strings 
of As or whatever you want at a daemon/program you suspect may have an 
overflow.

You look for log file errors or messages coming back saying something to 
the effect:

   Bad address: 0x41414141

or whatever is the hex equivalent of character you sent. A lot of UNIX 
daemons are started through inetd/xinetd, where the incoming connection 
ends up being a socket with stdin,stdout, and stderr connected to it, so 
any error messages caused by the buffer overflow might well come down 
the TCP connection just prior to it dropping.

Windows does things differently, so one would have to look in log files 
for equivalent messages on that platform.

-- 
Richard Sharpe, <A HREF="mailto:rsharpe@ns.aus.com">rsharpe@ns.aus.com</A>, LPIC-1
www.samba.org, www.ethereal.com, SAMS Teach Yourself Samba
in 24 Hours, Special Edition, Using Samba

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
