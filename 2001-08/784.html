<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: IpChains" -->
<!-- FromName="'Michael Neuling'" -->
<!-- FromEmail="Michael.Neuling@keyworks.com.au" -->
<!-- ToName="" -->
<!-- ToEmail="darryl.merritt@dda.com.au" -->
<!-- Date="Tue, 21 Aug 2001 21:40:22 +0800" -->
<!-- Id="20010821134023.027462195B@vodka.keyworks.com.au" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: IpChains</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Michael Neuling &lt;<I><A HREF="mailto:Michael.Neuling@keyworks.com.au">Michael.Neuling@keyworks.com.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:darryl.merritt@dda.com.au">darryl.merritt@dda.com.au</A></I>&gt;
  Date: Tue, 21 Aug 2001 21:40:22 +0800
</PRE>
<H1>Re: IpChains</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Darryl,

&gt; I've been using ipchains on RedHat V6.2 to count packets and bytes of the
&gt; data going through..
&gt; Every 5 minutes my script does a
&gt; 
&gt; ipchains -L -Z -v &gt;&gt; accts.txt
&gt; 
&gt; and so I get the data for the previous 5 minutes, and the counters get
&gt; reset.
&gt; 
&gt; I've copied the same script to a RedHat V7.1 PC and when the same command
&gt; runs, the counters dont get reset.. so I get a cumulative amount from when
&gt; the chains were created.
&gt; 
&gt; The man page says the counters should be reset using the -Z switch..
&gt; 
&gt; Any ideas?

Redhat 7.1 uses a 2.4.2 kernel which uses the IPChains backwards
compatibility module.  

Looking at the kernel code, you can't read and reset at the same time
anymore with IPChains.  You will need to read and then reset, in two
different commands so you will lose a few bytes.  You could insert a
blocking rule while you are doing it to make sure no packets get
through during that time but that'll break other stuff I'm guessing.

If this is not acceptable then revert back to a 2.2 kernel or try
rewriting your firewall rules to IPTables.  
</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
