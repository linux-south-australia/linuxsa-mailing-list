<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Blocking Code Red ingress to your ISP network" -->
<!-- FromName="'Simon Hackett'" -->
<!-- FromEmail="simon@internode.com.au" -->
<!-- ToName="" -->
<!-- ToEmail="linuxsa@linuxsa.org.au, aussie-isp@aussie.net" -->
<!-- Date="Fri, 10 Aug 2001 00:08:15 +0930" -->
<!-- Id="p05100307b7984e5a4bdc@[150.101.234.83]" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Blocking Code Red ingress to your ISP network</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Simon Hackett &lt;<I><A HREF="mailto:simon@internode.com.au">simon@internode.com.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;<BR>        &lt;<I><A HREF="mailto: aussie-isp@aussie.net"> aussie-isp@aussie.net</A></I>&gt;
  Date: Fri, 10 Aug 2001 00:08:15 +0930
</PRE>
<H1>Blocking Code Red ingress to your ISP network</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Yay.

Daryl Collins here @ Internode has just installed the magic bullet 
fix from Cisco, the one I posted to Aussie-Isp yesterday, which uses 
'NBAR' (Network Based Application Recognition) - i.e. Stateful 
inspection of incoming packet flows - to find, and kill, incoming 
Code Red attacks before the 'get' finishes reaching the destination 
web server.

So our customer base can finally stop counting Code Red sheep in 
their web logs, and we can stop putting out new brush fires every day 
when more of our customers get broken into and generate more attack 
streams outbound.

The initial tcp connection still arrives on the customer machine, but 
it gets suspended by IOS, just as the signature 'nasty' GET request 
is about to be delivered. So they become harmless distractions.

[Pop quiz: Which of our customers had the highest number of 
compromised machines? One that offers commercial MSCE courses. Argh]

Anyway - the blocking appears effective (so far) - and it is 
effective -without- transparently proxying incoming web requests or 
blocking all ingress to port 80 for our customers (ugh).

Got to love that Cisco IOS. The bugs drive you mad, but the features 
actually do more than make up for it. The feature set underneath NBAR 
is truly scary in its depth.

Interestingly, we're seeing around 60-90 kilobits per second of 
blocked probes right now. It'll be interesting to see how high that 
number gets at its peak.

If you can load a recent version of IOS onto your core router, think 
about doing your bit to turn these damn things off. Put a wall up and 
stop them (at last!)

Cheers,
Simon
-- 

---
Simon Hackett, Technical Director, Internode Systems Pty Ltd
31 York St [PO Box 284, Rundle Mall], Adelaide, SA 5000 Australia
Email: <A HREF="mailto:simon@internode.com.au">simon@internode.com.au</A>  Web: <A HREF="http://www.on.net">http://www.on.net</A>
Phone: +61-8-8223-2999          Fax: +61-8-8223-1777

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
