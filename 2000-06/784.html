<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Sendmail filtering" -->
<!-- FromName="Daryl Tester" -->
<!-- FromEmail="dt@picknowl.com.au" -->
<!-- ToName="Matthew Geddes" -->
<!-- ToEmail="mgeddes@xavier.sa.edu.au" -->
<!-- Date="Mon, 26 Jun 2000 14:06:56 +0930" -->
<!-- Id="3956DDE8.26BA725C@picknowl.com.au" -->
<!-- Reference="3956A2A8.50396253@xavier.sa.edu.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Sendmail filtering</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Daryl Tester &lt;<I><A HREF="mailto:dt@picknowl.com.au">dt@picknowl.com.au</A></I>&gt;
  To  : Matthew Geddes &lt;<I><A HREF="mailto:mgeddes@xavier.sa.edu.au">mgeddes@xavier.sa.edu.au</A></I>&gt;
  Date: Mon, 26 Jun 2000 14:06:56 +0930
</PRE>
<H1>Re: Sendmail filtering</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Matthew Geddes wrote:

&gt; A quick non-language specific hack to get a point across. I apologise
&gt; for any confusion.

Grep is non-language specific?  :-)

&gt;&gt; I don't know enough Sendmail 8.10.x - 

&gt; Well worth it if just for it's LDAP-based routing. ;-)

Oh, I knew it did _that_ (but then so did 8.9.3 with the right patches).

&gt; Agreed. But the actual message itself contains the encoded attachment
&gt; and a couple of lines of text that contains the filename of the
&gt; attachment. 

Yes.

&gt; sendmail obviously ignores this, but given that the file
&gt; name is there, it should be possible to bounce the message based on the
&gt; filename.

Yes.

&gt; This may not seem very useful, but it will mean that I can
&gt; prevent any .VBS-based worms from getting any where near the few Outlook
&gt; clients I have left.

I've never said otherwise.  I agree (or, "Yes.").

&gt; I disagree that it is necessary to decode attachments just to find the
&gt; filename.

And here, I disagree with your disagreement.  And now we're back to
square one.

&gt; I think the text in the message goes something like:
&gt; 
&gt; Content-type: xxxxxx/xxxx; name="virus.vbs"

And had I been filtering my mail as per your recommendation, I would
have just dropped this mail message, because it would have been a
(false) positive match.  Had you decoded the message in a MIME fashion,
you wouldn't even have "seen" the string "Content-type" unless you
were examining the contents of the containers.  You would, however,
have known the MIME type of each container sent to you (unless they
slip it into a ZIP file, which is a real possibility, apparently).

Firstly, you seem bent out of shape over "decode" - it's not an intensive
processing unless you wish to extract the octet stream of the contents 
(you're willing to grep an entire file, which is only slightly less
overhead).  If you decode it correctly, you won't get a false positive
like the above scenario.  Secondly, that Content-type: line can be split
over two lines (and frequently is), just like an RFC header.  Your pattern
matcher will have to take that (and other variations) into account.  Yet
all this is handled for you already by tools that other people have written.
None in one hand, a dozen in the other.


Regards,
  Daryl Tester

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
