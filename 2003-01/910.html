<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Mechanisms to stop DOS attack on email Servers" -->
<!-- FromName="'Simon Hackett'" -->
<!-- FromEmail="simon@internode.com.au" -->
<!-- ToName="" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Tue, 21 Jan 2003 17:38:43 +1030" -->
<!-- Id="p05111706ba52a0e244e1@[192.83.231.42]" -->
<!-- Reference="003201c2c115$37e677c0$bf5391a2@HYSA" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Mechanisms to stop DOS attack on email Servers</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Simon Hackett &lt;<I><A HREF="mailto:simon@internode.com.au">simon@internode.com.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Tue, 21 Jan 2003 17:38:43 +1030
</PRE>
<H1>Re: Mechanisms to stop DOS attack on email Servers</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Not exactly.

'straight' SMTP offers no defense from what you suggest.

However, 'ESMTP' does.

You can configure sendmail to insist that remote senders use Extended 
SMTP, and you can configure ESMTP with a maximum incoming message 
size.

Of course, if you do enforce 'ESMTP only' then only ESMTP-speaking 
senders can reach you - which cuts out a substantial chunk of older 
mail servers all over the Internet, so much so that you might find 
that the 'cure' is worse than the 'cause'.

So that leaves you setting up a block on max incoming message size 
which works efficiently with ESMTP sources and inefficiently (receive 
it all and then decide) for SMTP senders.

In practice its probably better to do specific, per-sender, blocking, 
and NOT blocking based on attachment size at all.

Why? Because blocking based on attachment size has its own pitfalls 
(think about two mail servers, both with a 5Mb max message size. Now 
think about what happens when a person sends a 10Mb mail outbound 
from one to the other, and it bounces because its 'too big' - bounces 
including a full copy of its contents.

Now think about how the first mail server will handle the bounce - by 
bouncing it back because its too big. And so on, and so on, and so on.

i.e. believe it or not, in general terms you're more likely to CREATE 
a mail message DOS attack by enforcing inbound message size limits. 
In general terms, either swallow the firehose, put in a 
specific-to-that-sender-only block if you get attacked, or get your 
ISP to rate limit your link such that you can afford what you might 
get sent.

Simon

At 4:50 PM +1030 21/1/03, Michael Selge wrote:
&gt;What (if any) means are available to stop mail servers being sent extremely
&gt;large attachments and lots of them. I'm led to believe there is no header
&gt;information on SMTP data packets as to the size of an email attachment.
&gt;
&gt;After the whole email is received you can obviously reject it as being too
&gt;big but you have already wasted the bandwidth receiving it. Someone that
&gt;doesn't like you could theoretically send lots of very large attachments and
&gt;cause your mailserver to crash and it would cost them sweet FA as most ISPs
&gt;don't count uploads.
&gt;
&gt;Regards
&gt;
&gt;Michael Selge
&gt;
&gt;--
&gt;LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.openprojects.net
&gt;To unsubscribe from the LinuxSA list:
&gt;   mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject


-- 


Simon Hackett, Managing Director, Internode Systems Pty Ltd
Level 3, 132 Grenfell St, Adelaide SA 5000 AUSTRALIA
[PO Box 284, Rundle Mall], Adelaide, SA 5000 Australia]
Email: <A HREF="mailto:simon@internode.com.au">simon@internode.com.au</A>  Web: <A HREF="http://www.internode.on.net">http://www.internode.on.net</A>
Phone: +61-8-8228-2999          Fax: +61-8-8235-6999

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.openprojects.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
