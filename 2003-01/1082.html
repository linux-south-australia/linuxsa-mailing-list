<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE: Anti-virus & Anti-spam on sendmail" -->
<!-- FromName="'Jim O'Halloran'" -->
<!-- FromEmail="Jim@kendle.com.au" -->
<!-- ToName="'David Lloyd'" -->
<!-- ToEmail="lloy0076@adam.com.au" -->
<!-- Date="Wed, 29 Jan 2003 09:12:37 +1030" -->
<!-- Id="71478A90CD21D711B81D0007E9C5A80204A9C0@KCSSERVER" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE: Anti-virus & Anti-spam on sendmail</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Jim O &lt;<I><A HREF="mailto:Jim@kendle.com.au">Jim@kendle.com.au</A></I>&gt;
  To  : David Lloyd &lt;<I><A HREF="mailto:lloy0076@adam.com.au">lloy0076@adam.com.au</A></I>&gt;
  Date: Wed, 29 Jan 2003 09:12:37 +1030
</PRE>
<H1>RE: Anti-virus & Anti-spam on sendmail</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
David,

I'm not complaining about Amavis as such, I accept that doing a proper job
of virus scanning email and attachments is a resource intensive job.  We
already run Amavis in daemon mode, but the McAfee scanner we run doesn't
have a daemon mode we can use.  At the end of the day, the Amavis + McAfee
solution we run is well worth it.  I can't tell you the number of times its
prevented virus infections both internally and with our clients.  

I guess the point I was making (and perhaps could have articulated a little
better) was that virus scanning does add some considerable overhead (as
you've explained).  We process 600+ messages a day on a P75 and sendmail
will periodically stop accepting connections due to high load average.
Hence my comment that performance was "borderline acceptable".  There is no
significant delay in email delivery most of the time, only when the server
gets hit with a couple of large emails at a time and the load average soars.


On the weekends, we process 100-200 messages a day and we have no problems
with load.  So if Matthew is evaluating Anti-Virus solutions, he may need to
take hardware requirements into account as well if he's running comparably
ancient equipment like we (and some others on this list) run.  My statements
weren't meant as a criticism of Amavis in any way (I think its a brilliant
product), more to make the original poster aware of my experiences on (very)
low end hardware in case that was relevant to his environment.

Jim.

PS: I've recently contributed patches to the logwatch project
(www.logwatch.org) which will report on the number of messages per day
scanned by Amavis and load average events in the sendmail logs, to assist
with monitoring these things.  These patches were included in version 4.3 of
logwatch released about a week ago.

-----Original Message-----
From: David Lloyd [mailto:<A HREF="mailto:lloy0076@adam.com.au">lloy0076@adam.com.au</A>]
Sent: Tuesday, 28 January 2003 22:37
To: Jim O'Halloran
Cc: <A HREF="mailto:mwestern@affairs.net.au">mwestern@affairs.net.au</A>; <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>
Subject: Re: Anti-virus & Anti-spam on sendmail



Jim et al,

&gt; We use Amavis with McAfee on our mail server...  Amavis is a
&gt; performance bottleneck, but that's mainly because its processing an
&gt; average of 600 messages a day on a Pentium 75 with 32mb of RAM. 
&gt; Performance is barely acceptable under load, but if you have
&gt; respectable hardware it'd be fine.  

I'm not sure any solution could do much better than AmaVis. Conceptually
AmaVis:

1) unrolls all messages into a spooling directory
 - i.e extracts the message and all MIME parts

2) invokes a virus scanner on the parts

3) works out results

4) deals with the message appropriately

Now, AmaVis can be run in daemon mode and I suspect that a virus scanner
could be run in daemon mode which would avoid a lot of process creation
but the above step, especially (1) and (2) take a long time.

No matter what you run.

And you can't really expect AmaVis to put (1) into memory because the
"real viruses" (such as the love bug) generally bombard mail servers. So
you sort of have to plan for the worst.

*sigh*


DSL

(Bill should write a little virus checker into Windows that says "You
are running a GPL program - this will taint the Windows Kernel!")

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
