<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE: squid running to aliased IPs, and user IP accounting" -->
<!-- FromName="'David Rowlands'" -->
<!-- FromEmail="davidr@empower.com.au" -->
<!-- ToName="'Toby Corkindale'" -->
<!-- ToEmail="tjcorkin@sa.pracom.com.au" -->
<!-- Date="Thu, 5 Jul 2001 11:01:00 +0930" -->
<!-- Id="51AEEE2767C2D311843A00A0CC51043F330B12@EINSTEIN" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE: squid running to aliased IPs, and user IP accounting</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: David Rowlands &lt;<I><A HREF="mailto:davidr@empower.com.au">davidr@empower.com.au</A></I>&gt;
  To  : Toby Corkindale &lt;<I><A HREF="mailto:tjcorkin@sa.pracom.com.au">tjcorkin@sa.pracom.com.au</A></I>&gt;
  Date: Thu, 5 Jul 2001 11:01:00 +0930
</PRE>
<H1>RE: squid running to aliased IPs, and user IP accounting</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Toby,

I'm doing something very similar.

I use a utility called ipac to monitor bandwidth. You can find it at
<A HREF="http://www.comlink.apc.org/~moritz/ipac.html">http://www.comlink.apc.org/~moritz/ipac.html</A> 

It produces nice graphs etc. The docs say you can do it on a per IP basis,
but it gets tricky if you are using ip masquerading, but it can be done and
it tells you how.

I have actually used it on my network at home, and can get very good stats
on how much bandwitdth each IP address is using.

Let me know if you need more info.

&gt; -----Original Message-----
&gt; From: Toby Corkindale [mailto:<A HREF="mailto:tjcorkin@sa.pracom.com.au">tjcorkin@sa.pracom.com.au</A>]
&gt; Sent: Thursday, July 05, 2001 10:50 AM
&gt; To: <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>
&gt; Subject: squid running to aliased IPs, and user IP accounting
&gt; 
&gt; 
&gt; Hiya
&gt; 
&gt; I never seem to get replies to my questions, but here's 
&gt; another one anyway..
&gt; 
&gt; First Q:
&gt; I want to do IP accounting on a per-user basis. I was sure there was
&gt; something around to do this on linux - can someone point me 
&gt; in the right
&gt; direction?
&gt; 
&gt; Second Q:
&gt; I've also been trying to get squid running on several 
&gt; different IPs. Not for
&gt; incoming requests, but using the tcp_outgoing parameter to 
&gt; set the IP it
&gt; uses to retreive things itself. The idea being that I can use 
&gt; iptables to
&gt; account for the bandwidth to the different IPs.
&gt; (and have all the squids peer to a central server and/or each other)
&gt; 
&gt; The problem is, I can't even get this to work with a single 
&gt; squid & single
&gt; IP address.
&gt; Everything works fine, until i set the tcp_outgoing address to be
&gt; 192.168.0.40, which is an aliased ip on eth0:1.
&gt; At this point, squid seems to fail to connect to anything external.
&gt; I've failed to figure out why - squid succeeds when it does 
&gt; the initial DNS
&gt; tests, btw. Accorrding to tcpdump i don't even see squid 
&gt; attempt to connect
&gt; to the destination website though?
&gt; 
&gt; Has anyone had something like this going?
&gt; 
&gt; 
&gt; 
&gt; If I can get per-user accounting, then I'll just run each squid as a
&gt; different user. Easy.
&gt; I need the per-user stuff anyway, for the users themselves.
&gt; However, I can see myself ending up writing a perl script to rip
&gt; cache-misses data per user for a single squid cache, although 
&gt; this isn't so
&gt; accurate.
&gt; Also, I've considered running one squid, thats only listening 
&gt; on loopback,
&gt; and then have a pass-thru proxy (eg. perl script or 
&gt; something) sitting on
&gt; multiple aliased IPs, that just pass thru to the main squid 
&gt; proxy, and keep
&gt; track of the data flowing both ways.
&gt; 
&gt; Thanks,
&gt; 
&gt; Toby
&gt; 
&gt; np. Snog - The prole song
&gt; 
&gt; -- 
&gt;  Toby Corkindale
&gt;  UNIX Developer, Core Tech R&D
&gt;  Technology SA, Pracom Ltd
&gt;  288 Glen Osmond Road
&gt;  Fullarton,	5063
&gt;  South Australia
&gt;  Tel: +61 8 8202 9075
&gt;  Fax: +61 8 8202 9001
&gt;  mailto:<A HREF="mailto:Toby.Corkindale@sa.pracom.com.au">Toby.Corkindale@sa.pracom.com.au</A>
&gt;  <A HREF="http://www.sa.pracom.com.au/">http://www.sa.pracom.com.au/</A>
&gt; 
&gt;                   PRIVILEGED - PRIVATE AND CONFIDENTIAL
&gt; 
&gt;    Privileged/Confidential Information may be contained in 
&gt; this message.
&gt;    If you are not the addressee indicated in this message, you may not
&gt;    copy or deliver this message to anyone.  In such case, you should
&gt;    destroy this message and notify the sender by reply email. 
&gt; Opinions,
&gt;    conclusions and other information in this message that do 
&gt; not relate
&gt;    to the official business of this organisation shall be 
&gt; understood as
&gt;    neither given nor endorsed by it.
&gt; 
&gt; -- 
&gt; LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on 
&gt; irc.linux.org.au
&gt; To unsubscribe from the LinuxSA list:
&gt;   mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as 
&gt; the subject
&gt; 

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
