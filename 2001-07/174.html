<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE: squid running to aliased IPs, and user IP accounting" -->
<!-- FromName="'Toby Corkindale'" -->
<!-- FromEmail="tjcorkin@sa.pracom.com.au" -->
<!-- ToName="'David Rowlands'" -->
<!-- ToEmail="davidr@empower.com.au" -->
<!-- Date="Thu, 5 Jul 2001 11:21:19 +0930 (CST)" -->
<!-- Id="Pine.LNX.4.33.0107051120150.28718-100000@localhost.localdomain" -->
<!-- Reference="51AEEE2767C2D311843A00A0CC51043F330B12@EINSTEIN" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE: squid running to aliased IPs, and user IP accounting</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Toby Corkindale &lt;<I><A HREF="mailto:tjcorkin@sa.pracom.com.au">tjcorkin@sa.pracom.com.au</A></I>&gt;
  To  : David Rowlands &lt;<I><A HREF="mailto:davidr@empower.com.au">davidr@empower.com.au</A></I>&gt;
  Date: Thu, 5 Jul 2001 11:21:19 +0930 (CST)
</PRE>
<H1>RE: squid running to aliased IPs, and user IP accounting</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Cheers David,

one question - the FAQ looks like it only works with pre-iptables
firewalling? (for ipac 1.x anyway)
Have you got it running with iptables?

Toby

On Thu, 5 Jul 2001, David Rowlands wrote:

&gt; Toby,
&gt;
&gt; I'm doing something very similar.
&gt;
&gt; I use a utility called ipac to monitor bandwidth. You can find it at
&gt; <A HREF="http://www.comlink.apc.org/~moritz/ipac.html">http://www.comlink.apc.org/~moritz/ipac.html</A>
&gt;
&gt; It produces nice graphs etc. The docs say you can do it on a per IP basis,
&gt; but it gets tricky if you are using ip masquerading, but it can be done and
&gt; it tells you how.
&gt;
&gt; I have actually used it on my network at home, and can get very good stats
&gt; on how much bandwitdth each IP address is using.
&gt;
&gt; Let me know if you need more info.
&gt;
&gt; &gt; -----Original Message-----
&gt; &gt; From: Toby Corkindale [mailto:<A HREF="mailto:tjcorkin@sa.pracom.com.au">tjcorkin@sa.pracom.com.au</A>]
&gt; &gt; Sent: Thursday, July 05, 2001 10:50 AM
&gt; &gt; To: <A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>
&gt; &gt; Subject: squid running to aliased IPs, and user IP accounting
&gt; &gt;
&gt; &gt;
&gt; &gt; Hiya
&gt; &gt;
&gt; &gt; I never seem to get replies to my questions, but here's
&gt; &gt; another one anyway..
&gt; &gt;
&gt; &gt; First Q:
&gt; &gt; I want to do IP accounting on a per-user basis. I was sure there was
&gt; &gt; something around to do this on linux - can someone point me
&gt; &gt; in the right
&gt; &gt; direction?
&gt; &gt;
&gt; &gt; Second Q:
&gt; &gt; I've also been trying to get squid running on several
&gt; &gt; different IPs. Not for
&gt; &gt; incoming requests, but using the tcp_outgoing parameter to
&gt; &gt; set the IP it
&gt; &gt; uses to retreive things itself. The idea being that I can use
&gt; &gt; iptables to
&gt; &gt; account for the bandwidth to the different IPs.
&gt; &gt; (and have all the squids peer to a central server and/or each other)
&gt; &gt;
&gt; &gt; The problem is, I can't even get this to work with a single
&gt; &gt; squid & single
&gt; &gt; IP address.
&gt; &gt; Everything works fine, until i set the tcp_outgoing address to be
&gt; &gt; 192.168.0.40, which is an aliased ip on eth0:1.
&gt; &gt; At this point, squid seems to fail to connect to anything external.
&gt; &gt; I've failed to figure out why - squid succeeds when it does
&gt; &gt; the initial DNS
&gt; &gt; tests, btw. Accorrding to tcpdump i don't even see squid
&gt; &gt; attempt to connect
&gt; &gt; to the destination website though?
&gt; &gt;
&gt; &gt; Has anyone had something like this going?
&gt; &gt;
&gt; &gt;
&gt; &gt;
&gt; &gt; If I can get per-user accounting, then I'll just run each squid as a
&gt; &gt; different user. Easy.
&gt; &gt; I need the per-user stuff anyway, for the users themselves.
&gt; &gt; However, I can see myself ending up writing a perl script to rip
&gt; &gt; cache-misses data per user for a single squid cache, although
&gt; &gt; this isn't so
&gt; &gt; accurate.
&gt; &gt; Also, I've considered running one squid, thats only listening
&gt; &gt; on loopback,
&gt; &gt; and then have a pass-thru proxy (eg. perl script or
&gt; &gt; something) sitting on
&gt; &gt; multiple aliased IPs, that just pass thru to the main squid
&gt; &gt; proxy, and keep
&gt; &gt; track of the data flowing both ways.
&gt; &gt;
&gt; &gt; Thanks,
&gt; &gt;
&gt; &gt; Toby
&gt; &gt;
&gt; &gt; np. Snog - The prole song
&gt; &gt;

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
