<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Bash help" -->
<!-- FromName="'Tim Riley'" -->
<!-- FromEmail="tr@rebel.net.au" -->
<!-- ToName="'Richard Russell'" -->
<!-- ToEmail="richardrussell@internode.on.net" -->
<!-- Date="Wed, 18 Jul 2001 00:12:37 +0930" -->
<!-- Id="20010718001237.A1139@rebel.net.au" -->
<!-- Reference="HKEMJGGDNENEDGGDCJBBAELNCJAA.richardrussell@internode.on.net" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Bash help</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Tim Riley &lt;<I><A HREF="mailto:tr@rebel.net.au">tr@rebel.net.au</A></I>&gt;
  To  : Richard Russell &lt;<I><A HREF="mailto:richardrussell@internode.on.net">richardrussell@internode.on.net</A></I>&gt;
  Date: Wed, 18 Jul 2001 00:12:37 +0930
</PRE>
<H1>Re: Bash help</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Tue, Jul 17, 2001 at 11:34:42PM +0930, Richard Russell wrote:

&lt;snip&gt;

&gt; &gt; I am extending protopkg to make it into a tool which will be used in the
&gt; &gt; situation of a ports system.  The reason I want one file instead of
&gt; &gt; three is becuase that way it is very easy to have multiple versions (ie.
&gt; &gt; multuple files) of a port in its directory - better to have three files
&gt; &gt; for three versions instead of nine.
&gt; 
&gt; "ports" as in BSD?
&gt; 
&gt; personally, I'd go for either different directories or a revision control
&gt; system... :)

Yes, ports as in BSD, but for Slackware Linux :)  I will be using a
directory tree:

ie. portsroot/x11-apps/xmms/prototype-xmms-1.2.0

Something like that, I may change the name of the build file though -
prototype is odd.  The need for havinf only one file instead of three
was for having prototype files for multiple versions of xmms in the
directory.

&lt;snip&gt;

&gt; &gt; &gt; &gt; There is a read_rules() function that extracts the information between
&gt; &gt; &gt; &gt; the flag name passed to it as an argument.  This is it below:
&gt; &gt; &gt;
&gt; &gt; &gt; where? in the prototype file?
&gt; &gt;
&gt; &gt; No.  The read_rules() function is in the protopkg script/program.  The
&gt; &gt; prototype file itself is never run, its functions are called by
&gt; &gt; protopkg.
&gt; 
&gt; ah -- so there are four files, and you are merging three into one, and
&gt; keeping the generic script... I see...

There were three files initially - protopkg, sources, and rules.  I am
merging those three into one, which will be taken and used by the
protopkg script itself.  I think we are on the same page here.

&lt;snip example prototype file&gt;

&gt; &gt; The text between the 'package' flags is the stuff called by protopkg to
&gt; &gt; compile and install the package. 100% bash.  The rest is not bash code,
&gt; &gt; just lines of data that the protpkg scrip interprets.
&gt; 
&gt; ok -- I notice that the "lines of data" between the sources and conf flags
&gt; look like URLs and files respectively... I assume they could be lists of
&gt; URLs/files -- if they are pretty regular data, then it should be easy:
&gt; 
&gt; Personally, to provide what looks to me like the same functionality, I'd
&gt; consider replacing them with a function like (note my syntax is very rusty):
&gt; 
&gt; read_lines()
&gt; {
&gt; 	if [$1 == "sources"]
&gt; 	then
&gt; 		cat &lt;&lt; EOF
&gt; &lt;sources text&gt;
&gt; EOF
&gt; 	elif [$1 == "conf"]
&gt; 	then
&gt; 		cat &lt;&lt; EOF
&gt; &lt;sources text&gt;
&gt; EOF
&gt; 	fi
&gt; }
&gt; 

I don't entirely understand that which this script does.  How does this
function know what text it is catting?  Is the text piped to it from
read_rules()?

&gt; ...and removing the definition of read_lines() from the original script... I
&gt; suppose it depends quite how `read_lines()` is used in the script itself...
&gt; if all it does is set an environment variable, then just set that variable
&gt; in the prototype <A HREF="file:">file:</A>
&gt; 
&gt; $SOURCES = "source1\n\
&gt; source2\n\
&gt; source3"
&gt; 
&gt; etc
&gt; 

Yes, I had considered that - it might just be easier to parse a
multi-line variable, for both the sources, and the config file rules.
The problem is, however, that for each of these, there may be two
"words" per line, or only one...

&gt; perhaps even make `read_lines_conf()` etc...
&gt; 
&gt; does this help? I'm now interested in solving your problem, so you'd better
&gt; tell me :)
&gt; 

You've lost me a little here, unfortunately - just with regard to the
use of the read_line() function...  could you explain it a little more?

Thanks again,

Tim


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
