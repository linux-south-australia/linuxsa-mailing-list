<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: SYN states" -->
<!-- FromName="'Charles Williams'" -->
<!-- FromEmail="hosting.mailing.list.account@acnshosting.com" -->
<!-- ToName="'Daryl Tester'" -->
<!-- ToEmail="Daryl.Tester@iocane.com.au" -->
<!-- Date="Sat, 14 Jul 2001 16:46:29 +0200" -->
<!-- Id="000901c10c73$cd38ab20$fe0aa8c0@chucks" -->
<!-- Reference="024d01c10c5c$16755f80$fe0aa8c0@chucks" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: SYN states</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Charles Williams &lt;<I><A HREF="mailto:hosting.mailing.list.account@acnshosting.com">hosting.mailing.list.account@acnshosting.com</A></I>&gt;
  To  : Daryl Tester &lt;<I><A HREF="mailto:Daryl.Tester@iocane.com.au">Daryl.Tester@iocane.com.au</A></I>&gt;
  Date: Sat, 14 Jul 2001 16:46:29 +0200
</PRE>
<H1>Re: SYN states</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
----- Original Message -----
From: "Daryl Tester" &lt;<A HREF="mailto:Daryl.Tester@iocane.com.au">Daryl.Tester@iocane.com.au</A>&gt;
To: "Charles Williams" &lt;<A HREF="mailto:hosting.mailing.list.account@acnshosting.com">hosting.mailing.list.account@acnshosting.com</A>&gt;
Cc: "LinuxSA" &lt;<A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A>&gt;
Sent: Saturday, July 14, 2001 4:03 PM
Subject: Re: SYN states


&gt; Charles Williams wrote:
&gt;
&gt; &gt;&gt; Have you looked into SYN cookies?
&gt;
&gt; &gt; Syn cookies is ok but only after 3 or more connections from the same
client
&gt; &gt; is dropped.
&gt;
&gt; SYN cookies do not drop connections; SYN cookies, for want of a better
&gt; explanation, maintain state without using memory during the initial
&gt; handshake via a (crypto) hashing function.  Its reason for existence is
&gt; to prevent resource starvation issues under SYN flood attacks, forged or
&gt; otherwise.

Who said anything about syncookies dropping a connection?

&gt;
&gt; &gt; Thus the need to verify the SYN before a port is opened.
&gt;
&gt; Doesn't this just shift the problem to the machine in front of
&gt; the firewall?  How does it stop having its SYN queue from
&gt; being flooded, whether in kernel or user space?  More to the
&gt; point, why isn't the firewall capable of handling this?
&gt;

NO. Read it again. this is not the firewalls responsibility.  This is a TCP
issue only.

&gt; &gt; However, you must first catch the SYN as it leaves TCP and
&gt; &gt; before it hits the firewall.  Otherwise you will have an
&gt; &gt; open port on a firewall until it times out.
&gt;
&gt; No, the "port doesn't open" until you receive the final ACK back from
&gt; the client, at least at the application level - this is the point
&gt; where accept() unblocks (for normal blocking listening sockets) and
&gt; returns the new file descriptor.  What is most likely happening is
&gt; that your firewall is maintaining data between SYN (SYN-ACK) and ACK,
&gt; which is where the DoS is coming in.

wrong. read the rfc.  the port that the connection comes in on is the one
that is open and awaiting info.

&gt;
&gt; &gt; Whereas if you can catch it
&gt; &gt; before it hits the firewall and verify that the connection is
established
&gt; &gt; you can pass the session to the firewall without losing performance as
the
&gt; &gt; time the port is open without connection and until timeout coupled with
the
&gt; &gt; magnatude of the attack is what kills the server.
&gt;
&gt; Is your firewall and server one and the same?

could be.  depends on how it's set up.

&gt;
&gt; &gt; Once the attack is underway and the syn proxy sees that it is recieving
&gt; &gt; constant incomplete syns from client it is added to the bad IP DB and
ALL
&gt; &gt; connections are refused to that client for approx. 24-48 hours (when the
DB
&gt; &gt; is cleared of old IP's) thus dialin IP's are open again inside of 24
hours
&gt; &gt; for use.
&gt;
&gt; Cool - so someone could start a forged SYN flood of, say, some large ISP's
&gt; proxy cache farm, and this software would obligingly block it?  That
&gt; smells of DoS too.

How?  DoS is external to internal and unwanted.  Also, the packets from the
cache farm would be out of sync anyway and not work.  All that would happen
is a bunch of resets are generated and the IP is eventually blocked as a Bad
IP.

chuck


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
