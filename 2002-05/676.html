<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: [Opinion] Portscan = automatic iptables complete block??" -->
<!-- FromName="'Matthew Moyle-Croft'" -->
<!-- FromEmail="mmc@mmc.com.au" -->
<!-- ToName="'Matthew Western'" -->
<!-- ToEmail="mwestern@affairs.net.au" -->
<!-- Date="Fri, 24 May 2002 09:40:39 +0930 (CST)" -->
<!-- Id="Pine.LNX.4.33.0205240933120.16654-100000@tsunami.mmc.com.au" -->
<!-- Reference="FD14944A4C95D211AF350004AC4C55A405860CB9@MX" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: [Opinion] Portscan = automatic iptables complete block??</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Matthew Moyle-Croft &lt;<I><A HREF="mailto:mmc@mmc.com.au">mmc@mmc.com.au</A></I>&gt;
  To  : Matthew Western &lt;<I><A HREF="mailto:mwestern@affairs.net.au">mwestern@affairs.net.au</A></I>&gt;
  Date: Fri, 24 May 2002 09:40:39 +0930 (CST)
</PRE>
<H1>Re: [Opinion] Portscan = automatic iptables complete block??</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Becareful.  Otherwise someone will start scanning valid ports faking the src 
ip address.  Also, you have to have a very very good idea about what's a 
scan or not.  If I send you a rapid sucession of emails that may trigger it 
too.

ie.  Say you deal with bigcompany.com on a regular basis.  A nasty person 
can scan your smtp ports with fake src of bigcompany.com's mail server and 
thus easily gives you a DoS.  Also, if someone knows your internal IP range 
they could use that unless you're careful.  variation 2 is just to ensure 
that every scan is from a unique source ip (distributed scanning anyone?)

Personally, I don't think it's worth it, unless the ports are obscure (in 
which case WHY are they open at all??).  If you've got open ports then they 
should be able to cope on their own.  Blocking ports in this manner is 
really only useful to stop DoS via resource overloading (ie. opening up all 
the connections to a service and stopping anyone else using it).  This 
should really be handled separately I think.

Another thing is that these days people do a scan/attack very separately and 
often from separate ip ranges on very different times. 

An analogy is:
- leaving all the windows and doors in the house open and waiting until 
  someone goes through one of them and THEN locking only that door or 
  stopping only that person from going through all the others.  You're 
  better off fitting secure screendoors.

Sorry for my rambling.  

MMC
--
On Fri, 24 May 2002, Matthew Western wrote:

&gt; Hi all,
&gt; What does everyone thing about haveing a script that says if a port scan is
&gt; detected from a number, completely block that number for a given period of
&gt; time.  Hour, day whatever...  does this sound heavy handed?
&gt; thanks
&gt; Matthew
&gt; 
&gt; 

-- 
Matthew
--
<A HREF="mailto:Matthew@Moyle-Croft.com">Matthew@Moyle-Croft.com</A>    | <A HREF="mailto:mmc@mmc.com.au">mmc@mmc.com.au</A>        |    <A HREF="mailto:mmc@206gti.net">mmc@206gti.net</A>
<A HREF="http://www.Moyle-Croft.com">http://www.Moyle-Croft.com</A> | <A HREF="http://www.mmc.com.au">http://www.mmc.com.au</A> | <A HREF="http://206gti.net">http://206gti.net</A>

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
