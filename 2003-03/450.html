<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="Re: Which is faster on modern CPU?" -->
<!-- FromName="'Alan Kennington'" -->
<!-- FromEmail="ak.linuxsa@topology.org" -->
<!-- ToName="'LinuxSA'" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Mon, 10 Mar 2003 16:16:10 +1030" -->
<!-- Id="20030310161610.A31476@dog.topology.org" -->
<!-- Reference="3E6C13F7.9000304@aarnet.edu.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: Re: Which is faster on modern CPU?</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: Alan Kennington &lt;<I><A HREF="mailto:ak.linuxsa@topology.org">ak.linuxsa@topology.org</A></I>&gt;
  To  : LinuxSA &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Mon, 10 Mar 2003 16:16:10 +1030
</PRE>
<H1>Re: Which is faster on modern CPU?</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
On Mon, Mar 10, 2003 at 02:56:31PM +1030, Glen Turner wrote:
&gt; Matthew Moyle-Croft wrote:
[...]
&gt; 
&gt; &gt; How often is the code likely to execute?  If not often then either way 
&gt; &gt; probably makes no diff.
&gt; 
&gt; Every incoming and outgoing TCP packet.  In the fast
&gt; and slow paths.  Genuinely performance critical code :-(
[...]

Glen,

Until 1989, I used to habitually optimize all of my code,
whether it was in assembly language or C etc.
I did this by memorizing the cycle times of all instructions
and doing the arithmetic on critical loops especially.

But then in 1989, after spending an hour or two optimizing a
criticial loop in some simulation software which was taking
over 24 hours for each run (on either a 68020 or sparc),
I triumphantly removed about half of the code in the loop,
and certainly removing a chunk of code cannot possibly do anything
but speed up the software.
But the software went about 50% slower!
It turned out that some code that the loop was invoking ended
up aligned modulo the cache size in the same place as the main loop code.
Further experiments showed that this was happening frequently.

As a result of this experience, I almost completely gave up all attempts
at optimization.
Over the years, I've found that virtually all of my old 68k tricks
to tighly optimize loops generally make the software go slower.

My conclusion has been, especially as CPUs become so incomprehensible that
the manufacturers genuinely don't understand them well enough to be
able to specify cycle times in spec sheets, that _fine_ optimization
is always folly, and even throwing out big chunks of sluggish-looking
code has a completely random effect on run-time.

If I'm wrong about this, I'm happy to be corrected.

Cheers,
Alan Kennington.

PS. I still often carefully micro-design my code to save a couple of cycles
here and there, but that's just an old habit from the days when a
5-second job card on a 1 Mips CPU with 100kB RAM cost A$25.

-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A> IRC: #linuxsa on irc.freenode.net
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
