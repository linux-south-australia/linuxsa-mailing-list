<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="RE:  Perl question" -->
<!-- FromName="'David de Groot'" -->
<!-- FromEmail="david@viking.org.au" -->
<!-- ToName="'LinuxSA Mailing List'" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Thu, 8 Mar 2001 14:27:04 +1030" -->
<!-- Id="74323241416.20010308142704@viking.org.au" -->
<!-- Reference="3AA6FB4B.CF820442@aarnet.edu.au" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: RE:  Perl question</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: David de Groot &lt;<I><A HREF="mailto:david@viking.org.au">david@viking.org.au</A></I>&gt;
  To  : LinuxSA Mailing List &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Thu, 8 Mar 2001 14:27:04 +1030
</PRE>
<H1>RE:  Perl question</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
Thursday, March 08, 2001, 1:53:55 PM, Glen wrote:


&gt; Can someone please explain how the following short extract
&gt; of Perl code operates as I am planning to use it in a lecture
&gt; to demonstrate how not to write structured programs.
&lt;snip&gt;

Restructuring I get something like this:

#!/usr/bin/perl -w
# 531-byte qrpff-fast, Keith Winstein and Marc Horowitz &lt;<A HREF="mailto:sipb-iap-dvd@mit.edu">sipb-iap-dvd@mit.edu</A>&gt;
# MPEG 2 PS VOB file on stdin -&gt; descrambled output on stdout
# arguments: title key bytes in least to most-significant order
$_='while(read+STDIN,$_,2048) {
      $a=29;
      $b=73;
      $c=142;
      $t=255;
      @t=map {
           $_%16or$t^=$c^=($m=(11,10,116,100,11,122,20,100)[$_/16%8]) &110;
           $t^=(72,@z=(64,72,$a^=12*($_%16-2?0:$m&17)),$b^=$_%64?12:0,@z)[$_%8]
      } (16..271);
      if((@a=unx"C*",$_)[20]&48) {
         $h=5;
         $_=unxb24,join"",@b=map{xB8,unxb8,chr($_^$a[--$h+84])}@ARGV;
         s/...$/1$&/;
         $d=unxV,xb25,$_;
         $e=256|(ord$b[4])&lt;&lt;9|ord$b[3];
         $d=$d&gt;&gt;8^($f=$t&($d&gt;&gt;12^$d&gt;&gt;4^$d^$d/8))&lt;&lt;17,$e=$e&gt;&gt;8^($t&($g=($q=$e&gt;&gt;14&7^$e)^$q*8^$q&lt;&lt;6))&lt;&lt;9,$_=$t[$_]^(($h&gt;&gt;=8)+=$f+(~$g&$t)) <A HREF="mailto:for@a">for@a</A>[128..$#a]
      }
      print+x"C*",@a
   }';
   s/x/pack+/g;
eval


Still  doesn't  tell  me much. I know it's a DeCSS implementation, but
it's pretty obfuscated.
-- 
David de Groot                          mailto:<A HREF="mailto:david@viking.org.au">david@viking.org.au</A>
<A HREF="http://vikings.homeip.net/~david">http://vikings.homeip.net/~david</A>


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
