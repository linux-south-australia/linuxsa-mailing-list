<HTML>
<!-- EmailData="Start" -->
<!-- Version="1.1" -->
<!-- Subject="PHP weirdness" -->
<!-- FromName="'James Mclean'" -->
<!-- FromEmail="james@adam.com.au" -->
<!-- ToName="" -->
<!-- ToEmail="linuxsa@linuxsa.org.au" -->
<!-- Date="Sat, 28 Apr 2001 12:12:53 +930 (CST)" -->
<!-- Id="988425773.3aea2e2dad40b@thunder.adam.com.au" -->
<!-- Reference="" -->
<!-- X-Face="" -->
<!-- X-URL="" -->
<!-- EmailData="End" -->
<HEAD>
<TITLE>LinuxSA Mailing List: PHP weirdness</TITLE>
</HEAD>
<BODY BGCOLOR=#FFFFFF><H1>LinuxSA Mailing list archives</H1>
<!-- IndexControl1="Start" -->
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<HR>
<!-- IndexControl1="End" -->
<!-- Header="Start" -->
<PRE>
  From: James Mclean &lt;<I><A HREF="mailto:james@adam.com.au">james@adam.com.au</A></I>&gt;
  To  : &lt;<I><A HREF="mailto:linuxsa@linuxsa.org.au">linuxsa@linuxsa.org.au</A></I>&gt;
  Date: Sat, 28 Apr 2001 12:12:53 +930 (CST)
</PRE>
<H1>PHP weirdness</H1>
<!-- Header="End" -->
<!-- Body="Start" -->
<PRE>
List,

I have done a fair bit of PHP stuff before, but I have come across a problem 
that has me stumped...

OK, here is the piece of code in question...

&lt;?
 $user = megan;

     if(strcmp($username,$user)) {
        setcookie("username",$username, time() -2682000);
        echo" Not Permitted to view";
        exit;
    } else {

        echo" &lt;body bgcolor=\"ffffff\" link=\"#000000\" vlink=\"#000000\" 
alink=\"#000000\"&gt;";
        echo" &lt;font face=\"Verdana,Arial,Helvetica,sans-serif\" size=\"2\"&gt;";
        echo" You have been permitted to stream the following MP3 files:";
        echo" &lt;br&gt;";
       
        //script to read what songs a user has access to

        $fp = popen("/bin/ls *.html","r");

        $str = fgets($fp,1024);

        while(!feof($fp)) {
            $str2 = $str;
            $str = ereg_replace(" ","%20","$str");
            echo"&lt;a href=\"$str\"&gt;";
            $str2 = ereg_replace(".html","","$str2");
            $str2 = ucwords($str2);
            echo" $str2";
            echo"&lt;/a&gt;";
            echo"&lt;br&gt;";
            $str = fgets($fp,1024);
        }
    }

    print"&lt;a href=\"../../logout.php\"&gt;Log Out&lt;/a&gt;";

?&gt;


Now, On my machine running Debian 2.2 and Mozilla 0.8, it works as expected. 
Lets me log in, and authenticates correctly. However, on a Win98 client running 
MSIE5 it fails to authenticate, but in another case, on another machine Win98 
and MSIE5 it works as expected, and also on an NT4 machine with MSIE5 it fails 
to work correctly.

If i add in a ! (NOT) before the first strcmp, it works as expected on the 
machines it previously failed on, and fails on the machines it previously 
worked on!

I am absolutely stumped. One idea though, Do all browsers need the "path" 
specified in the cookie? Would this affect it?

So that i am not totally OT the server is a redhat 6.1, with Apache/1.3.12 
(Unix) PHP/4.0.0.

Any help excellent,

Cheers!

james mclean


-- 
LinuxSA WWW: <A HREF="http://www.linuxsa.org.au/">http://www.linuxsa.org.au/</A>  IRC: #linuxsa on irc.linux.org.au
To unsubscribe from the LinuxSA list:
  mail <A HREF="mailto:linuxsa-request@linuxsa.org.au">linuxsa-request@linuxsa.org.au</A> with "unsubscribe" as the subject

</PRE>
<!-- Body="End" -->
<!-- IndexControl2="Start" -->
<HR>
Index:
[<A HREF="thread.html">thread</A>]
[<A HREF="date.html">date</A>]
[<A HREF="subject.html">subject</A>]
[<A HREF="author.html">author</A>]
[<A HREF="stats.html">stats</A>]
<!-- IndexControl2="End" -->
<HR><FONT SIZE=+1>Return to the <A HREF=/mailing-list/>LinuxSA Mailing List Information</A> Page</FONT></BODY>
</HTML>
